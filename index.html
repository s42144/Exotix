<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exotix - Crypto Trading Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --dark: #1e293b;
            --dark-light: #334155;
            --light: #f1f5f9;
            --white: #ffffff;
            --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-2: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --gradient-3: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --shadow: 0 10px 30px rgba(0,0,0,0.1);
            --shadow-lg: 0 20px 60px rgba(0,0,0,0.2);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding-bottom: 80px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 15px 20px;
            border-radius: 20px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 28px;
            font-weight: bold;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .balance-display {
            display: flex;
            align-items: center;
            gap: 10px;
            background: var(--gradient);
            padding: 10px 20px;
            border-radius: 15px;
            color: white;
            font-weight: bold;
        }

        .balance-display img {
            width: 30px;
            height: 30px;
            border-radius: 50%;
        }

        /* Main Content */
        .main-content {
            display: none;
        }

        .main-content.active {
            display: block;
        }

        /* Section Headers */
        .section-header {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
        }

        .section-header h2 {
            color: var(--dark);
            font-size: 24px;
            margin-bottom: 5px;
        }

        .section-header p {
            color: #64748b;
            font-size: 14px;
        }

        /* Trading Plans */
        .plans-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .plan-card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: var(--shadow);
            transition: transform 0.3s, box-shadow 0.3s;
            position: relative;
            overflow: hidden;
        }

        .plan-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: var(--gradient);
        }

        .plan-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .plan-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .plan-pair {
            font-size: 20px;
            font-weight: bold;
            color: var(--dark);
        }

        .plan-badge {
            background: var(--gradient);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }

        .plan-chart {
            width: 100%;
            height: 150px;
            margin: 15px 0;
            border-radius: 10px;
            overflow: hidden;
        }

        .plan-details {
            margin: 15px 0;
        }

        .plan-detail-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #e2e8f0;
        }

        .plan-detail-row:last-child {
            border-bottom: none;
        }

        .plan-detail-label {
            color: #64748b;
            font-size: 14px;
        }

        .plan-detail-value {
            color: var(--dark);
            font-weight: bold;
            font-size: 14px;
        }

        .plan-price {
            font-size: 32px;
            font-weight: bold;
            color: var(--primary);
            text-align: center;
            margin: 15px 0;
        }

        .plan-button {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 15px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            background: var(--gradient);
            color: white;
        }

        .plan-button:hover {
            transform: scale(1.02);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .plan-button:disabled {
            background: #94a3b8;
            cursor: not-allowed;
            transform: none;
        }

        /* My Trades */
        .trades-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .trade-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: var(--shadow);
        }

        .trade-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .trade-pair {
            font-size: 18px;
            font-weight: bold;
            color: var(--dark);
        }

        .trade-status {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            background: var(--secondary);
            color: white;
        }

        .trade-progress {
            margin: 15px 0;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: #e2e8f0;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: var(--gradient-3);
            transition: width 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 12px;
        }

        .countdown-timer {
            text-align: center;
            margin: 15px 0;
            font-size: 24px;
            font-weight: bold;
            color: var(--primary);
        }

        .claim-button {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 15px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            background: var(--secondary);
            color: white;
            transition: all 0.3s;
        }

        .claim-button:hover {
            transform: scale(1.02);
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.4);
        }

        .claim-button:disabled {
            background: #94a3b8;
            cursor: not-allowed;
        }

        /* Wallet */
        .wallet-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .wallet-option {
            background: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: var(--shadow);
        }

        .wallet-option:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .wallet-option i {
            font-size: 48px;
            margin-bottom: 15px;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .wallet-option h3 {
            color: var(--dark);
            font-size: 18px;
        }

        .form-container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: var(--shadow);
            display: none;
        }

        .form-container.active {
            display: block;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--dark);
            font-weight: 600;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
        }

        .qr-container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            box-shadow: var(--shadow);
            display: none;
        }

        .qr-container.active {
            display: block;
        }

        .qr-container img {
            max-width: 300px;
            margin: 20px auto;
            border-radius: 15px;
        }

        .copy-field {
            display: flex;
            gap: 10px;
            margin: 15px 0;
        }

        .copy-field input {
            flex: 1;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 14px;
        }

        .copy-btn {
            padding: 15px 25px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .copy-btn:hover {
            background: var(--primary-dark);
        }

        .submit-btn {
            width: 100%;
            padding: 15px;
            background: var(--gradient);
            color: white;
            border: none;
            border-radius: 15px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .submit-btn:hover {
            transform: scale(1.02);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .back-btn {
            width: 100%;
            padding: 15px;
            background: #64748b;
            color: white;
            border: none;
            border-radius: 15px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 10px;
        }

        /* History */
        .history-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .history-item {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: var(--shadow);
        }

        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .history-type {
            font-weight: bold;
            color: var(--dark);
        }

        .history-status {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }

        .history-status.pending {
            background: var(--warning);
            color: white;
        }

        .history-status.approved {
            background: var(--secondary);
            color: white;
        }

        .history-status.rejected {
            background: var(--danger);
            color: white;
        }

        .history-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 15px;
        }

        .history-detail {
            font-size: 14px;
        }

        .history-detail-label {
            color: #64748b;
        }

        .history-detail-value {
            color: var(--dark);
            font-weight: 600;
        }

        /* Referrals */
        .referral-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: var(--shadow);
        }

        .stat-value {
            font-size: 32px;
            font-weight: bold;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #64748b;
            font-size: 14px;
        }

        .referral-link-container {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: var(--shadow);
            margin-bottom: 20px;
        }

        .referral-link-container h3 {
            color: var(--dark);
            margin-bottom: 15px;
        }

        .share-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .share-btn {
            padding: 15px;
            border: none;
            border-radius: 15px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .share-btn.telegram {
            background: #0088cc;
            color: white;
        }

        .share-btn.twitter {
            background: #1da1f2;
            color: white;
        }

        .share-btn:hover {
            transform: scale(1.02);
            box-shadow: var(--shadow);
        }

        .referral-list {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: var(--shadow);
        }

        .referral-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            border-bottom: 1px solid #e2e8f0;
        }

        .referral-item:last-child {
            border-bottom: none;
        }

        .referral-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .referral-info {
            flex: 1;
        }

        .referral-name {
            font-weight: bold;
            color: var(--dark);
        }

        .referral-balance {
            color: #64748b;
            font-size: 14px;
        }

        .referral-commission {
            color: var(--secondary);
            font-weight: bold;
        }

        /* Tasks */
        .tasks-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .task-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--shadow);
            transition: transform 0.3s;
        }

        .task-card:hover {
            transform: translateY(-5px);
        }

        .task-icon {
            width: 60px;
            height: 60px;
            border-radius: 15px;
            background: var(--gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
        }

        .task-icon i {
            font-size: 30px;
            color: white;
        }

        .task-title {
            font-size: 18px;
            font-weight: bold;
            color: var(--dark);
            margin-bottom: 10px;
        }

        .task-description {
            color: #64748b;
            font-size: 14px;
            margin-bottom: 15px;
        }

        .task-reward {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .task-reward-amount {
            font-size: 20px;
            font-weight: bold;
            color: var(--secondary);
        }

        .task-button {
            width: 100%;
            padding: 12px;
            background: var(--gradient);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .task-button:hover {
            transform: scale(1.02);
        }

        .task-button:disabled {
            background: #94a3b8;
            cursor: not-allowed;
        }

        /* Profile */
        .profile-container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: var(--shadow);
        }

        .profile-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .profile-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: var(--gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            color: white;
            font-size: 40px;
            font-weight: bold;
        }

        .profile-name {
            font-size: 24px;
            font-weight: bold;
            color: var(--dark);
            margin-bottom: 5px;
        }

        .profile-id {
            color: #64748b;
            font-size: 14px;
        }

        .redeem-section {
            margin-top: 30px;
            padding-top: 30px;
            border-top: 2px solid #e2e8f0;
        }

        .redeem-section h3 {
            color: var(--dark);
            margin-bottom: 15px;
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            box-shadow: 0 -5px 20px rgba(0,0,0,0.1);
            padding: 10px 0;
            z-index: 1000;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-around;
            align-items: center;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            padding: 10px 15px;
            cursor: pointer;
            transition: all 0.3s;
            border-radius: 10px;
            color: #64748b;
        }

        .nav-item.active {
            background: var(--gradient);
            color: white;
        }

        .nav-item i {
            font-size: 24px;
        }

        .nav-item span {
            font-size: 12px;
            font-weight: 600;
        }

        /* Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }

        /* Loading Spinner */
        .spinner {
            border: 4px solid #f3f4f6;
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Notifications */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: var(--shadow-lg);
            z-index: 2000;
            display: none;
            max-width: 350px;
        }

        .notification.show {
            display: block;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
            }
            to {
                transform: translateX(0);
            }
        }

        .notification.success {
            border-left: 5px solid var(--secondary);
        }

        .notification.error {
            border-left: 5px solid var(--danger);
        }

        .notification.warning {
            border-left: 5px solid var(--warning);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .plans-grid {
                grid-template-columns: 1fr;
            }

            .wallet-options {
                grid-template-columns: 1fr;
            }

            .referral-stats {
                grid-template-columns: 1fr;
            }

            .share-buttons {
                grid-template-columns: 1fr;
            }

            .tasks-grid {
                grid-template-columns: 1fr;
            }

            .nav-item span {
                display: none;
            }
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #64748b;
        }

        .empty-state i {
            font-size: 64px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .empty-state h3 {
            font-size: 20px;
            margin-bottom: 10px;
        }

        .empty-state p {
            font-size: 14px;
        }
    </style>
<script src="https://sites.super.myninja.ai/_assets/ninja-daytona-script.js"></script>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="logo">
                <i class="fas fa-chart-line"></i>
                Exotix
            </div>
            <div class="balance-display">
                <img src="https://i.postimg.cc/85tyqGqs/images-6.jpg" alt="USDT">
                <span id="userBalance">0.00</span> USDT
            </div>
        </div>

        <!-- Trade Section -->
        <div id="tradeSection" class="main-content active">
            <div class="section-header">
                <h2>Trading Plans</h2>
                <p>Choose your investment plan and start earning daily</p>
            </div>
            <div id="plansGrid" class="plans-grid">
                <!-- Plans will be loaded here -->
            </div>
        </div>

        <!-- My Trades Section -->
        <div id="myTradesSection" class="main-content">
            <div class="section-header">
                <h2>My Active Trades</h2>
                <p>Track your investments and claim rewards</p>
            </div>
            <div id="tradesList" class="trades-list">
                <!-- Active trades will be loaded here -->
            </div>
        </div>

        <!-- Wallet Section -->
        <div id="walletSection" class="main-content">
            <div class="section-header">
                <h2>Wallet</h2>
                <p>Manage your funds</p>
            </div>
            
            <div id="walletOptions" class="wallet-options">
                <div class="wallet-option" onclick="showDeposit()">
                    <i class="fas fa-plus-circle"></i>
                    <h3>Deposit</h3>
                </div>
                <div class="wallet-option" onclick="showWithdraw()">
                    <i class="fas fa-minus-circle"></i>
                    <h3>Withdraw</h3>
                </div>
                <div class="wallet-option" onclick="showHistory()">
                    <i class="fas fa-history"></i>
                    <h3>History</h3>
                </div>
                <div class="wallet-option" onclick="showActivities()">
                    <i class="fas fa-list"></i>
                    <h3>Activities</h3>
                </div>
            </div>

            <!-- Deposit Form -->
            <div id="depositForm" class="form-container">
                <h3>Deposit USDT</h3>
                <div class="form-group">
                    <label>Amount (Min: $30)</label>
                    <input type="number" id="depositAmount" placeholder="Enter amount" min="30">
                </div>
                <button class="submit-btn" onclick="processDeposit()">Continue</button>
                <button class="back-btn" onclick="backToWallet()">Back</button>
            </div>

            <!-- Deposit QR -->
            <div id="depositQR" class="qr-container">
                <h3>Scan QR Code to Deposit</h3>
                <p id="depositTimer" style="color: var(--danger); font-weight: bold; font-size: 20px; margin: 15px 0;"></p>
                <img src="https://i.postimg.cc/g2mgknm3/Screenshot-2025-10-17-16-28-28-211-com-ton-keeper-edit.jpg" alt="QR Code">
                
                <div class="copy-field">
                    <input type="text" value="UQBWOgFgB4B8qBCo8CNjDUNAtvUSosw4v7v9gkt0GVOaNLSz" readonly>
                    <button class="copy-btn" onclick="copyText('UQBWOgFgB4B8qBCo8CNjDUNAtvUSosw4v7v9gkt0GVOaNLSz')">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>

                <div class="form-group">
                    <label>Amount</label>
                    <div class="copy-field">
                        <input type="text" id="depositAmountDisplay" readonly>
                        <button class="copy-btn" onclick="copyAmount()">
                            <i class="fas fa-copy"></i>
                        </button>
                    </div>
                </div>

                <div class="form-group">
                    <label>Memo/Comment (Required)</label>
                    <div class="copy-field">
                        <input type="text" id="depositMemo" readonly>
                        <button class="copy-btn" onclick="copyMemo()">
                            <i class="fas fa-copy"></i>
                        </button>
                    </div>
                </div>

                <div class="form-group">
                    <label>Network</label>
                    <input type="text" value="TON" readonly>
                </div>

                <div class="form-group">
                    <label>Transaction Hash</label>
                    <input type="text" id="depositTxHash" placeholder="Enter transaction hash">
                </div>

                <button class="submit-btn" onclick="submitDeposit()">Submit Deposit</button>
                <button class="back-btn" onclick="backToWallet()">Back</button>
            </div>

            <!-- Withdraw Form -->
            <div id="withdrawForm" class="form-container">
                <h3>Withdraw USDT</h3>
                <div class="form-group">
                    <label>USDT TON Address (Required)</label>
                    <input type="text" id="withdrawAddress" placeholder="Enter your USDT TON address">
                </div>
                <div class="form-group">
                    <label>Amount (Min: $0.10)</label>
                    <input type="number" id="withdrawAmount" placeholder="Enter amount" min="0.10" step="0.01">
                </div>
                <div class="form-group">
                    <label>Memo/Comment (Optional)</label>
                    <input type="text" id="withdrawMemo" placeholder="Enter memo">
                </div>
                <button class="submit-btn" onclick="submitWithdraw()">Submit Withdrawal</button>
                <button class="back-btn" onclick="backToWallet()">Back</button>
            </div>

            <!-- History -->
            <div id="historyContainer" class="form-container">
                <h3>Transaction History</h3>
                <div id="historyList" class="history-list">
                    <!-- History items will be loaded here -->
                </div>
                <button class="back-btn" onclick="backToWallet()">Back</button>
            </div>

            <!-- Activities -->
            <div id="activitiesContainer" class="form-container">
                <h3>All Activities</h3>
                <div id="activitiesList" class="history-list">
                    <!-- Activities will be loaded here -->
                </div>
                <button class="back-btn" onclick="backToWallet()">Back</button>
            </div>
        </div>

        <!-- Referrals Section -->
        <div id="referralsSection" class="main-content">
            <div class="section-header">
                <h2>Referral Program</h2>
                <p>Earn 20% commission + $0.20 bonus per referral</p>
            </div>

            <div class="referral-stats">
                <div class="stat-card">
                    <div class="stat-value" id="totalReferrals">0</div>
                    <div class="stat-label">Total Referrals</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">$<span id="totalReferralEarnings">0.00</span></div>
                    <div class="stat-label">Total Earnings</div>
                </div>
            </div>

            <div class="referral-link-container">
                <h3>Your Referral Link</h3>
                <div class="copy-field">
                    <input type="text" id="referralLink" readonly>
                    <button class="copy-btn" onclick="copyReferralLink()">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>

                <div class="share-buttons">
                    <button class="share-btn telegram" onclick="shareOnTelegram()">
                        <i class="fab fa-telegram"></i>
                        Share on Telegram
                    </button>
                    <button class="share-btn twitter" onclick="shareOnTwitter()">
                        <i class="fab fa-twitter"></i>
                        Share on Twitter
                    </button>
                </div>
            </div>

            <div class="referral-list">
                <h3>My Referrals</h3>
                <div id="referralsList">
                    <!-- Referrals will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Tasks Section -->
        <div id="tasksSection" class="main-content">
            <div class="section-header">
                <h2>Tasks</h2>
                <p>Complete tasks and earn rewards</p>
            </div>
            <div id="tasksGrid" class="tasks-grid">
                <!-- Tasks will be loaded here -->
            </div>
        </div>

        <!-- Profile Section -->
        <div id="profileSection" class="main-content">
            <div class="profile-container">
                <div class="profile-header">
                    <div class="profile-avatar" id="profileAvatar">U</div>
                    <div class="profile-name" id="profileName">User</div>
                    <div class="profile-id">ID: <span id="profileUserId">000000</span></div>
                </div>

                <div class="redeem-section">
                    <h3>Redeem Code</h3>
                    <div class="form-group">
                        <label>Enter 8-digit code</label>
                        <input type="text" id="redeemCode" placeholder="Enter redemption code" maxlength="8">
                    </div>
                    <button class="submit-btn" onclick="redeemCode()">Redeem</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <div class="bottom-nav">
        <div class="nav-container">
            <div class="nav-item active" onclick="showSection('trade')">
                <i class="fas fa-chart-line"></i>
                <span>Trade</span>
            </div>
            <div class="nav-item" onclick="showSection('myTrades')">
                <i class="fas fa-briefcase"></i>
                <span>My Trades</span>
            </div>
            <div class="nav-item" onclick="showSection('wallet')">
                <i class="fas fa-wallet"></i>
                <span>Wallet</span>
            </div>
            <div class="nav-item" onclick="showSection('referrals')">
                <i class="fas fa-users"></i>
                <span>Referrals</span>
            </div>
            <div class="nav-item" onclick="showSection('tasks')">
                <i class="fas fa-tasks"></i>
                <span>Tasks</span>
            </div>
            <div class="nav-item" onclick="showSection('profile')">
                <i class="fas fa-user"></i>
                <span>Profile</span>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification">
        <div id="notificationContent"></div>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getDatabase, ref, set, get, update, push, onValue, query, orderByChild, equalTo } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';

        const firebaseConfig = {
            apiKey: "AIzaSyBfR97veh6idxb81mH6N5_Gq8-CpW2D7bE",
            authDomain: "jbhigfi.firebaseapp.com",
            databaseURL: "https://jbhigfi-default-rtdb.firebaseio.com",
            projectId: "jbhigfi",
            storageBucket: "jbhigfi.firebasestorage.app",
            messagingSenderId: "736760492095",
            appId: "1:736760492095:web:47b94412495e21c561c88a",
            measurementId: "G-ZZMHC9RTVT"
        };

        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        // Make Firebase available globally
        window.db = database;
        window.dbRef = ref;
        window.dbSet = set;
        window.dbGet = get;
        window.dbUpdate = update;
        window.dbPush = push;
        window.dbOnValue = onValue;
        window.dbQuery = query;
        window.dbOrderByChild = orderByChild;
        window.dbEqualTo = equalTo;

        // Telegram Bot API
        const TELEGRAM_BOT_TOKEN = '7930967027:AAG3AkEZrkKGxTFOyVHwN8VpA9HgusAdRmw';
        const TELEGRAM_API_URL = `https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}`;

        window.sendTelegramNotification = async function(chatId, message) {
            try {
                const response = await fetch(`${TELEGRAM_API_URL}/sendMessage`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        chat_id: chatId,
                        text: message,
                        parse_mode: 'HTML'
                    })
                });
                return await response.json();
            } catch (error) {
                console.error('Telegram notification error:', error);
            }
        };

        // Initialize user
        window.initUser = async function() {
            // Get user ID from Telegram WebApp or generate one
            let userId = localStorage.getItem('userId');
            if (!userId) {
                userId = 'user_' + Math.random().toString(36).substr(2, 9);
                localStorage.setItem('userId', userId);
            }

            window.currentUserId = userId;

            // Check if user exists in database
            const userRef = dbRef(database, `users/${userId}`);
            const snapshot = await dbGet(userRef);

            if (!snapshot.exists()) {
                // Create new user
                await dbSet(userRef, {
                    userId: userId,
                    balance: 0,
                    totalDeposits: 0,
                    totalWithdrawals: 0,
                    totalEarnings: 0,
                    referralEarnings: 0,
                    referralCount: 0,
                    createdAt: Date.now(),
                    hasDeposited: false,
                    telegramId: null,
                    username: 'User',
                    referredBy: null
                });
            }

            // Load user data
            loadUserData();
            loadPlans();
            loadUserTrades();
            loadReferrals();
            loadTasks();
        };

        window.loadUserData = async function() {
            const userRef = dbRef(database, `users/${window.currentUserId}`);
            const snapshot = await dbGet(userRef);
            
            if (snapshot.exists()) {
                const userData = snapshot.val();
                document.getElementById('userBalance').textContent = userData.balance.toFixed(2);
                document.getElementById('profileName').textContent = userData.username || 'User';
                document.getElementById('profileUserId').textContent = window.currentUserId;
                document.getElementById('profileAvatar').textContent = (userData.username || 'User')[0].toUpperCase();
                document.getElementById('totalReferrals').textContent = userData.referralCount || 0;
                document.getElementById('totalReferralEarnings').textContent = (userData.referralEarnings || 0).toFixed(2);
                
                // Set referral link
                const referralLink = `http://t.me/Exotix_Robot/myapp?start=${window.currentUserId}`;
                document.getElementById('referralLink').value = referralLink;
            }
        };

        // Initialize on load
        initUser();
    </script>

    <script>
        // Trading Plans Data
        const tradingPlans = [
            { pair: 'BTC/USDT', price: 3000, dailyEarning: 300, duration: 30, minInvest: 40 },
            { pair: 'ETH/USDT', price: 2000, dailyEarning: 200, duration: 30, minInvest: 40 },
            { pair: 'BNB/USDT', price: 1500, dailyEarning: 150, duration: 30, minInvest: 40 },
            { pair: 'SOL/USDT', price: 1200, dailyEarning: 120, duration: 30, minInvest: 40 },
            { pair: 'ADA/USDT', price: 1000, dailyEarning: 100, duration: 30, minInvest: 40 },
            { pair: 'XRP/USDT', price: 900, dailyEarning: 90, duration: 30, minInvest: 40 },
            { pair: 'DOT/USDT', price: 800, dailyEarning: 80, duration: 30, minInvest: 40 },
            { pair: 'DOGE/USDT', price: 700, dailyEarning: 70, duration: 30, minInvest: 40 },
            { pair: 'AVAX/USDT', price: 650, dailyEarning: 65, duration: 30, minInvest: 40 },
            { pair: 'MATIC/USDT', price: 600, dailyEarning: 60, duration: 30, minInvest: 40 },
            { pair: 'LINK/USDT', price: 550, dailyEarning: 55, duration: 30, minInvest: 40 },
            { pair: 'UNI/USDT', price: 500, dailyEarning: 50, duration: 30, minInvest: 40 },
            { pair: 'ATOM/USDT', price: 450, dailyEarning: 45, duration: 30, minInvest: 40 },
            { pair: 'LTC/USDT', price: 400, dailyEarning: 40, duration: 30, minInvest: 40 },
            { pair: 'TRX/USDT', price: 350, dailyEarning: 35, duration: 30, minInvest: 40 },
            { pair: 'FTM/USDT', price: 300, dailyEarning: 30, duration: 30, minInvest: 40 },
            { pair: 'ALGO/USDT', price: 250, dailyEarning: 25, duration: 30, minInvest: 40 },
            { pair: 'VET/USDT', price: 200, dailyEarning: 20, duration: 30, minInvest: 40 },
            { pair: 'ICP/USDT', price: 150, dailyEarning: 15, duration: 30, minInvest: 40 },
            { pair: 'NEAR/USDT', price: 100, dailyEarning: 10, duration: 30, minInvest: 40 }
        ];

        // Load Trading Plans
        function loadPlans() {
            const plansGrid = document.getElementById('plansGrid');
            plansGrid.innerHTML = '';

            tradingPlans.forEach((plan, index) => {
                const planCard = document.createElement('div');
                planCard.className = 'plan-card fade-in';
                planCard.innerHTML = `
                    <div class="plan-header">
                        <div class="plan-pair">${plan.pair}</div>
                        <div class="plan-badge">HOT</div>
                    </div>
                    <div class="plan-chart">
                        <canvas id="chart-${index}"></canvas>
                    </div>
                    <div class="plan-details">
                        <div class="plan-detail-row">
                            <span class="plan-detail-label">Daily Earning</span>
                            <span class="plan-detail-value">$${plan.dailyEarning}</span>
                        </div>
                        <div class="plan-detail-row">
                            <span class="plan-detail-label">Duration</span>
                            <span class="plan-detail-value">${plan.duration} Days</span>
                        </div>
                        <div class="plan-detail-row">
                            <span class="plan-detail-label">Total Return</span>
                            <span class="plan-detail-value">$${plan.dailyEarning * plan.duration}</span>
                        </div>
                        <div class="plan-detail-row">
                            <span class="plan-detail-label">Min. Investment</span>
                            <span class="plan-detail-value">$${plan.minInvest}</span>
                        </div>
                    </div>
                    <div class="plan-price">$${plan.price}</div>
                    <button class="plan-button" onclick="buyPlan(${index})" id="plan-btn-${index}">
                        <i class="fas fa-shopping-cart"></i> Buy Plan
                    </button>
                `;
                plansGrid.appendChild(planCard);

                // Draw simple chart
                setTimeout(() => drawChart(`chart-${index}`), 100);
            });

            // Check purchased plans
            checkPurchasedPlans();
        }

        // Draw Simple Chart
        function drawChart(canvasId) {
            const canvas = document.getElementById(canvasId);
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;

            const gradient = ctx.createLinearGradient(0, 0, canvas.width, 0);
            gradient.addColorStop(0, '#667eea');
            gradient.addColorStop(1, '#764ba2');

            ctx.strokeStyle = gradient;
            ctx.lineWidth = 3;
            ctx.beginPath();

            const points = 20;
            for (let i = 0; i < points; i++) {
                const x = (canvas.width / points) * i;
                const y = canvas.height / 2 + Math.sin(i * 0.5) * 30 + Math.random() * 20;
                
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            }
            ctx.stroke();
        }

        // Check Purchased Plans
        async function checkPurchasedPlans() {
            const tradesRef = window.dbRef(window.db, `trades/${window.currentUserId}`);
            const snapshot = await window.dbGet(tradesRef);
            
            if (snapshot.exists()) {
                const trades = snapshot.val();
                Object.values(trades).forEach(trade => {
                    if (trade.status === 'active') {
                        const btn = document.getElementById(`plan-btn-${trade.planIndex}`);
                        if (btn) {
                            btn.textContent = 'Purchased';
                            btn.disabled = true;
                        }
                    }
                });
            }
        }

        // Buy Plan
        async function buyPlan(planIndex) {
            const plan = tradingPlans[planIndex];
            
            // Get user balance
            const userRef = window.dbRef(window.db, `users/${window.currentUserId}`);
            const snapshot = await window.dbGet(userRef);
            
            if (!snapshot.exists()) {
                showNotification('error', 'User not found');
                return;
            }

            const userData = snapshot.val();
            
            if (userData.balance < plan.price) {
                showNotification('error', 'Insufficient balance. Please deposit first.');
                return;
            }

            // Check if already purchased
            const tradesRef = window.dbRef(window.db, `trades/${window.currentUserId}`);
            const tradesSnapshot = await window.dbGet(tradesRef);
            
            if (tradesSnapshot.exists()) {
                const trades = Object.values(tradesSnapshot.val());
                const alreadyPurchased = trades.some(t => t.planIndex === planIndex && t.status === 'active');
                
                if (alreadyPurchased) {
                    showNotification('warning', 'You have already purchased this plan');
                    return;
                }
            }

            // Deduct balance and create trade
            const newBalance = userData.balance - plan.price;
            await window.dbUpdate(userRef, { balance: newBalance });

            const tradeId = Date.now().toString();
            const tradeRef = window.dbRef(window.db, `trades/${window.currentUserId}/${tradeId}`);
            
            await window.dbSet(tradeRef, {
                tradeId: tradeId,
                planIndex: planIndex,
                pair: plan.pair,
                investmentAmount: plan.price,
                dailyEarning: plan.dailyEarning,
                duration: plan.duration,
                daysCompleted: 0,
                totalEarned: 0,
                status: 'active',
                purchaseDate: Date.now(),
                lastClaimDate: Date.now(),
                nextClaimDate: Date.now() + (24 * 60 * 60 * 1000)
            });

            // Log activity
            logActivity('trade_purchase', `Purchased ${plan.pair} plan for $${plan.price}`);

            // Send Telegram notification
            if (userData.telegramId) {
                window.sendTelegramNotification(
                    userData.telegramId,
                    `üéâ <b>Plan Purchased Successfully!</b>\n\n` +
                    `üíº Plan: ${plan.pair}\n` +
                    `üí∞ Investment: $${plan.price}\n` +
                    `üìà Daily Earning: $${plan.dailyEarning}\n` +
                    `‚è± Duration: ${plan.duration} days\n\n` +
                    `Your first claim will be available in 24 hours!`
                );
            }

            showNotification('success', `Successfully purchased ${plan.pair} plan!`);
            loadUserData();
            loadPlans();
            loadUserTrades();
        }

        // Load User Trades
        async function loadUserTrades() {
            const tradesRef = window.dbRef(window.db, `trades/${window.currentUserId}`);
            const snapshot = await window.dbGet(tradesRef);
            
            const tradesList = document.getElementById('tradesList');
            tradesList.innerHTML = '';

            if (!snapshot.exists()) {
                tradesList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-briefcase"></i>
                        <h3>No Active Trades</h3>
                        <p>Purchase a trading plan to start earning</p>
                    </div>
                `;
                return;
            }

            const trades = snapshot.val();
            Object.values(trades).forEach(trade => {
                if (trade.status === 'active') {
                    const tradeCard = createTradeCard(trade);
                    tradesList.appendChild(tradeCard);
                }
            });
        }

        // Create Trade Card
        function createTradeCard(trade) {
            const card = document.createElement('div');
            card.className = 'trade-card fade-in';
            
            const progress = (trade.daysCompleted / trade.duration) * 100;
            const canClaim = Date.now() >= trade.nextClaimDate;
            const timeUntilClaim = trade.nextClaimDate - Date.now();

            card.innerHTML = `
                <div class="trade-header">
                    <div class="trade-pair">${trade.pair}</div>
                    <div class="trade-status">Active</div>
                </div>
                <div class="trade-progress">
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${progress}%">
                            ${trade.daysCompleted}/${trade.duration} Days
                        </div>
                    </div>
                </div>
                <div class="plan-details">
                    <div class="plan-detail-row">
                        <span class="plan-detail-label">Investment</span>
                        <span class="plan-detail-value">$${trade.investmentAmount}</span>
                    </div>
                    <div class="plan-detail-row">
                        <span class="plan-detail-label">Daily Earning</span>
                        <span class="plan-detail-value">$${trade.dailyEarning}</span>
                    </div>
                    <div class="plan-detail-row">
                        <span class="plan-detail-label">Total Earned</span>
                        <span class="plan-detail-value">$${trade.totalEarned}</span>
                    </div>
                </div>
                <div class="countdown-timer" id="timer-${trade.tradeId}">
                    ${canClaim ? 'Ready to Claim!' : formatTime(timeUntilClaim)}
                </div>
                <button class="claim-button" onclick="claimReward('${trade.tradeId}')" 
                    ${!canClaim ? 'disabled' : ''} id="claim-btn-${trade.tradeId}">
                    <i class="fas fa-gift"></i> ${canClaim ? 'Claim Reward' : 'Claim in ' + formatTime(timeUntilClaim)}
                </button>
            `;

            // Update timer
            if (!canClaim) {
                setInterval(() => updateTimer(trade.tradeId, trade.nextClaimDate), 1000);
            }

            return card;
        }

        // Update Timer
        function updateTimer(tradeId, nextClaimDate) {
            const timerEl = document.getElementById(`timer-${tradeId}`);
            const btnEl = document.getElementById(`claim-btn-${tradeId}`);
            
            if (!timerEl || !btnEl) return;

            const timeLeft = nextClaimDate - Date.now();
            
            if (timeLeft <= 0) {
                timerEl.textContent = 'Ready to Claim!';
                btnEl.disabled = false;
                btnEl.innerHTML = '<i class="fas fa-gift"></i> Claim Reward';
            } else {
                timerEl.textContent = formatTime(timeLeft);
                btnEl.innerHTML = '<i class="fas fa-clock"></i> Claim in ' + formatTime(timeLeft);
            }
        }

        // Format Time
        function formatTime(ms) {
            const hours = Math.floor(ms / (1000 * 60 * 60));
            const minutes = Math.floor((ms % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((ms % (1000 * 60)) / 1000);
            return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        // Claim Reward
        async function claimReward(tradeId) {
            const tradeRef = window.dbRef(window.db, `trades/${window.currentUserId}/${tradeId}`);
            const snapshot = await window.dbGet(tradeRef);
            
            if (!snapshot.exists()) {
                showNotification('error', 'Trade not found');
                return;
            }

            const trade = snapshot.val();
            
            if (Date.now() < trade.nextClaimDate) {
                showNotification('warning', 'Claim not available yet');
                return;
            }

            // Update trade
            const newDaysCompleted = trade.daysCompleted + 1;
            const newTotalEarned = trade.totalEarned + trade.dailyEarning;
            const isCompleted = newDaysCompleted >= trade.duration;

            await window.dbUpdate(tradeRef, {
                daysCompleted: newDaysCompleted,
                totalEarned: newTotalEarned,
                lastClaimDate: Date.now(),
                nextClaimDate: Date.now() + (24 * 60 * 60 * 1000),
                status: isCompleted ? 'completed' : 'active'
            });

            // Update user balance
            const userRef = window.dbRef(window.db, `users/${window.currentUserId}`);
            const userSnapshot = await window.dbGet(userRef);
            const userData = userSnapshot.val();
            
            const newBalance = userData.balance + trade.dailyEarning;
            const newTotalEarnings = (userData.totalEarnings || 0) + trade.dailyEarning;
            
            await window.dbUpdate(userRef, {
                balance: newBalance,
                totalEarnings: newTotalEarnings
            });

            // Log activity
            logActivity('claim_reward', `Claimed $${trade.dailyEarning} from ${trade.pair}`);

            // Send Telegram notification
            if (userData.telegramId) {
                window.sendTelegramNotification(
                    userData.telegramId,
                    `üí∞ <b>Reward Claimed!</b>\n\n` +
                    `üíº Plan: ${trade.pair}\n` +
                    `üíµ Amount: $${trade.dailyEarning}\n` +
                    `üìä Progress: ${newDaysCompleted}/${trade.duration} days\n` +
                    `üíº New Balance: $${newBalance.toFixed(2)}\n\n` +
                    (isCompleted ? 'üéâ Plan completed!' : '‚è∞ Next claim in 24 hours')
                );
            }

            showNotification('success', `Successfully claimed $${trade.dailyEarning}!`);
            loadUserData();
            loadUserTrades();
        }

        // Wallet Functions
        function showDeposit() {
            document.getElementById('walletOptions').style.display = 'none';
            document.getElementById('depositForm').classList.add('active');
        }

        function showWithdraw() {
            document.getElementById('walletOptions').style.display = 'none';
            document.getElementById('withdrawForm').classList.add('active');
        }

        function showHistory() {
            document.getElementById('walletOptions').style.display = 'none';
            document.getElementById('historyContainer').classList.add('active');
            loadHistory();
        }

        function showActivities() {
            document.getElementById('walletOptions').style.display = 'none';
            document.getElementById('activitiesContainer').classList.add('active');
            loadActivities();
        }

        function backToWallet() {
            document.querySelectorAll('.form-container, .qr-container').forEach(el => {
                el.classList.remove('active');
            });
            document.getElementById('walletOptions').style.display = 'grid';
        }

        // Process Deposit
        function processDeposit() {
            const amount = parseFloat(document.getElementById('depositAmount').value);
            
            if (!amount || amount < 30) {
                showNotification('error', 'Minimum deposit amount is $30');
                return;
            }

            document.getElementById('depositForm').classList.remove('active');
            document.getElementById('depositQR').classList.add('active');
            document.getElementById('depositAmountDisplay').value = amount.toFixed(2);
            document.getElementById('depositMemo').value = `ExotixDP_${window.currentUserId}`;

            // Start 15 minute timer
            startDepositTimer();
        }

        // Start Deposit Timer
        function startDepositTimer() {
            const endTime = Date.now() + (15 * 60 * 1000);
            
            const timerInterval = setInterval(() => {
                const timeLeft = endTime - Date.now();
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    document.getElementById('depositTimer').textContent = 'Time expired!';
                    return;
                }

                const minutes = Math.floor(timeLeft / (1000 * 60));
                const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
                document.getElementById('depositTimer').textContent = 
                    `Time remaining: ${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        // Submit Deposit
        async function submitDeposit() {
            const amount = parseFloat(document.getElementById('depositAmountDisplay').value);
            const txHash = document.getElementById('depositTxHash').value.trim();

            if (!txHash) {
                showNotification('error', 'Please enter transaction hash');
                return;
            }

            const depositId = Date.now().toString();
            const depositRef = window.dbRef(window.db, `deposits/${depositId}`);
            
            await window.dbSet(depositRef, {
                depositId: depositId,
                userId: window.currentUserId,
                amount: amount,
                address: 'UQBWOgFgB4B8qBCo8CNjDUNAtvUSosw4v7v9gkt0GVOaNLSz',
                memo: `ExotixDP_${window.currentUserId}`,
                txHash: txHash,
                status: 'pending',
                createdAt: Date.now()
            });

            // Log activity
            logActivity('deposit_request', `Deposit request of $${amount} submitted`);

            showNotification('success', 'Deposit submitted! Waiting for admin approval.');
            backToWallet();
            
            // Clear form
            document.getElementById('depositAmount').value = '';
            document.getElementById('depositTxHash').value = '';
        }

        // Submit Withdraw
        async function submitWithdraw() {
            const address = document.getElementById('withdrawAddress').value.trim();
            const amount = parseFloat(document.getElementById('withdrawAmount').value);
            const memo = document.getElementById('withdrawMemo').value.trim();

            if (!address) {
                showNotification('error', 'Please enter withdrawal address');
                return;
            }

            if (!amount || amount < 0.10) {
                showNotification('error', 'Minimum withdrawal amount is $0.10');
                return;
            }

            // Check if user has deposited
            const userRef = window.dbRef(window.db, `users/${window.currentUserId}`);
            const snapshot = await window.dbGet(userRef);
            const userData = snapshot.val();

            if (!userData.hasDeposited) {
                showNotification('error', 'First time deposit required to withdraw');
                return;
            }

            if (userData.balance < amount) {
                showNotification('error', 'Insufficient balance');
                return;
            }

            const withdrawId = Date.now().toString();
            const withdrawRef = window.dbRef(window.db, `withdrawals/${withdrawId}`);
            
            await window.dbSet(withdrawRef, {
                withdrawId: withdrawId,
                userId: window.currentUserId,
                amount: amount,
                address: address,
                memo: memo,
                status: 'pending',
                createdAt: Date.now()
            });

            // Deduct balance temporarily
            await window.dbUpdate(userRef, {
                balance: userData.balance - amount
            });

            // Log activity
            logActivity('withdrawal_request', `Withdrawal request of $${amount} submitted`);

            showNotification('success', 'Withdrawal submitted! Waiting for admin approval.');
            backToWallet();
            loadUserData();
            
            // Clear form
            document.getElementById('withdrawAddress').value = '';
            document.getElementById('withdrawAmount').value = '';
            document.getElementById('withdrawMemo').value = '';
        }

        // Load History
        async function loadHistory() {
            const historyList = document.getElementById('historyList');
            historyList.innerHTML = '<div class="spinner"></div>';

            // Load deposits
            const depositsRef = window.dbRef(window.db, 'deposits');
            const depositsSnapshot = await window.dbGet(depositsRef);
            
            // Load withdrawals
            const withdrawalsRef = window.dbRef(window.db, 'withdrawals');
            const withdrawalsSnapshot = await window.dbGet(withdrawalsRef);

            const transactions = [];

            if (depositsSnapshot.exists()) {
                Object.values(depositsSnapshot.val()).forEach(deposit => {
                    if (deposit.userId === window.currentUserId) {
                        transactions.push({
                            type: 'Deposit',
                            ...deposit
                        });
                    }
                });
            }

            if (withdrawalsSnapshot.exists()) {
                Object.values(withdrawalsSnapshot.val()).forEach(withdrawal => {
                    if (withdrawal.userId === window.currentUserId) {
                        transactions.push({
                            type: 'Withdrawal',
                            ...withdrawal
                        });
                    }
                });
            }

            transactions.sort((a, b) => b.createdAt - a.createdAt);

            historyList.innerHTML = '';

            if (transactions.length === 0) {
                historyList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-history"></i>
                        <h3>No Transaction History</h3>
                        <p>Your transactions will appear here</p>
                    </div>
                `;
                return;
            }

            transactions.forEach(tx => {
                const item = document.createElement('div');
                item.className = 'history-item';
                item.innerHTML = `
                    <div class="history-header">
                        <div class="history-type">${tx.type}</div>
                        <div class="history-status ${tx.status}">${tx.status.toUpperCase()}</div>
                    </div>
                    <div class="history-details">
                        <div class="history-detail">
                            <div class="history-detail-label">Amount</div>
                            <div class="history-detail-value">$${tx.amount.toFixed(2)}</div>
                        </div>
                        <div class="history-detail">
                            <div class="history-detail-label">Date</div>
                            <div class="history-detail-value">${new Date(tx.createdAt).toLocaleDateString()}</div>
                        </div>
                        <div class="history-detail">
                            <div class="history-detail-label">Time</div>
                            <div class="history-detail-value">${new Date(tx.createdAt).toLocaleTimeString()}</div>
                        </div>
                        ${tx.type === 'Deposit' ? `
                            <div class="history-detail">
                                <div class="history-detail-label">TX Hash</div>
                                <div class="history-detail-value">${tx.txHash.substring(0, 10)}...</div>
                            </div>
                        ` : `
                            <div class="history-detail">
                                <div class="history-detail-label">Address</div>
                                <div class="history-detail-value">${tx.address.substring(0, 10)}...</div>
                            </div>
                        `}
                    </div>
                `;
                historyList.appendChild(item);
            });
        }

        // Load Activities
        async function loadActivities() {
            const activitiesList = document.getElementById('activitiesList');
            activitiesList.innerHTML = '<div class="spinner"></div>';

            const activitiesRef = window.dbRef(window.db, `activities/${window.currentUserId}`);
            const snapshot = await window.dbGet(activitiesRef);

            activitiesList.innerHTML = '';

            if (!snapshot.exists()) {
                activitiesList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-list"></i>
                        <h3>No Activities</h3>
                        <p>Your activities will appear here</p>
                    </div>
                `;
                return;
            }

            const activities = Object.values(snapshot.val()).sort((a, b) => b.timestamp - a.timestamp);

            activities.forEach(activity => {
                const item = document.createElement('div');
                item.className = 'history-item';
                item.innerHTML = `
                    <div class="history-header">
                        <div class="history-type">${activity.type.replace('_', ' ').toUpperCase()}</div>
                    </div>
                    <div class="history-details">
                        <div class="history-detail">
                            <div class="history-detail-label">Description</div>
                            <div class="history-detail-value">${activity.description}</div>
                        </div>
                        <div class="history-detail">
                            <div class="history-detail-label">Date</div>
                            <div class="history-detail-value">${new Date(activity.timestamp).toLocaleDateString()}</div>
                        </div>
                        <div class="history-detail">
                            <div class="history-detail-label">Time</div>
                            <div class="history-detail-value">${new Date(activity.timestamp).toLocaleTimeString()}</div>
                        </div>
                    </div>
                `;
                activitiesList.appendChild(item);
            });
        }

        // Log Activity
        async function logActivity(type, description) {
            const activityId = Date.now().toString();
            const activityRef = window.dbRef(window.db, `activities/${window.currentUserId}/${activityId}`);
            
            await window.dbSet(activityRef, {
                activityId: activityId,
                type: type,
                description: description,
                timestamp: Date.now()
            });
        }

        // Referrals
        async function loadReferrals() {
            const referralsList = document.getElementById('referralsList');
            referralsList.innerHTML = '<div class="spinner"></div>';

            const usersRef = window.dbRef(window.db, 'users');
            const snapshot = await window.dbGet(usersRef);

            referralsList.innerHTML = '';

            if (!snapshot.exists()) {
                referralsList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-users"></i>
                        <h3>No Referrals Yet</h3>
                        <p>Share your referral link to start earning</p>
                    </div>
                `;
                return;
            }

            const users = Object.values(snapshot.val());
            const referrals = users.filter(u => u.referredBy === window.currentUserId);

            if (referrals.length === 0) {
                referralsList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-users"></i>
                        <h3>No Referrals Yet</h3>
                        <p>Share your referral link to start earning</p>
                    </div>
                `;
                return;
            }

            referrals.forEach(referral => {
                const item = document.createElement('div');
                item.className = 'referral-item';
                item.innerHTML = `
                    <div class="referral-avatar">${(referral.username || 'U')[0].toUpperCase()}</div>
                    <div class="referral-info">
                        <div class="referral-name">${referral.username || 'User'}</div>
                        <div class="referral-balance">Balance: $${referral.balance.toFixed(2)}</div>
                    </div>
                    <div class="referral-commission">+$${((referral.totalDeposits || 0) * 0.2 + 0.20).toFixed(2)}</div>
                `;
                referralsList.appendChild(item);
            });
        }

        function copyReferralLink() {
            const link = document.getElementById('referralLink').value;
            navigator.clipboard.writeText(link);
            showNotification('success', 'Referral link copied!');
        }

        function shareOnTelegram() {
            const link = document.getElementById('referralLink').value;
            const text = `üöÄ Join Exotix Trading Platform!\n\nüí∞ Earn $0.20 for each referral\nüìà Get 20% commission on all deposits and earnings\n\n${link}`;
            window.open(`https://t.me/share/url?url=${encodeURIComponent(link)}&text=${encodeURIComponent(text)}`, '_blank');
        }

        function shareOnTwitter() {
            const link = document.getElementById('referralLink').value;
            const text = `üöÄ Join Exotix Trading Platform! üí∞ Earn $0.20 per referral + 20% commission! üìà`;
            window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(link)}`, '_blank');
        }

        // Tasks
        async function loadTasks() {
            const tasksGrid = document.getElementById('tasksGrid');
            tasksGrid.innerHTML = '<div class="spinner"></div>';

            const tasksRef = window.dbRef(window.db, 'tasks');
            const snapshot = await window.dbGet(tasksRef);

            tasksGrid.innerHTML = '';

            if (!snapshot.exists()) {
                tasksGrid.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-tasks"></i>
                        <h3>No Tasks Available</h3>
                        <p>Check back later for new tasks</p>
                    </div>
                `;
                return;
            }

            const tasks = Object.values(snapshot.val());

            tasks.forEach(task => {
                const card = document.createElement('div');
                card.className = 'task-card fade-in';
                card.innerHTML = `
                    <div class="task-icon">
                        <i class="${task.icon || 'fas fa-star'}"></i>
                    </div>
                    <div class="task-title">${task.title}</div>
                    <div class="task-description">${task.description}</div>
                    <div class="task-reward">
                        <span class="task-reward-amount">+$${task.reward}</span>
                    </div>
                    <button class="task-button" onclick="completeTask('${task.taskId}', '${task.link}', ${task.reward})">
                        Complete Task
                    </button>
                `;
                tasksGrid.appendChild(card);
            });
        }

        async function completeTask(taskId, link, reward) {
            // Open task link
            window.open(link, '_blank');

            // Check if already completed
            const completedRef = window.dbRef(window.db, `completedTasks/${window.currentUserId}/${taskId}`);
            const snapshot = await window.dbGet(completedRef);

            if (snapshot.exists()) {
                showNotification('warning', 'Task already completed');
                return;
            }

            // Mark as completed
            await window.dbSet(completedRef, {
                taskId: taskId,
                completedAt: Date.now()
            });

            // Add reward to balance
            const userRef = window.dbRef(window.db, `users/${window.currentUserId}`);
            const userSnapshot = await window.dbGet(userRef);
            const userData = userSnapshot.val();

            await window.dbUpdate(userRef, {
                balance: userData.balance + reward
            });

            // Log activity
            logActivity('task_completed', `Completed task and earned $${reward}`);

            showNotification('success', `Task completed! Earned $${reward}`);
            loadUserData();
        }

        // Redeem Code
        async function redeemCode() {
            const code = document.getElementById('redeemCode').value.trim().toUpperCase();

            if (!code || code.length !== 8) {
                showNotification('error', 'Please enter a valid 8-digit code');
                return;
            }

            const codeRef = window.dbRef(window.db, `redeemCodes/${code}`);
            const snapshot = await window.dbGet(codeRef);

            if (!snapshot.exists()) {
                showNotification('error', 'Invalid redemption code');
                return;
            }

            const codeData = snapshot.val();

            if (codeData.used) {
                showNotification('error', 'Code already used');
                return;
            }

            if (codeData.usedBy && codeData.usedBy.includes(window.currentUserId)) {
                showNotification('error', 'You have already used this code');
                return;
            }

            // Random amount between min and max
            const amount = (Math.random() * (codeData.maxAmount - codeData.minAmount) + codeData.minAmount).toFixed(2);

            // Update user balance
            const userRef = window.dbRef(window.db, `users/${window.currentUserId}`);
            const userSnapshot = await window.dbGet(userRef);
            const userData = userSnapshot.val();

            await window.dbUpdate(userRef, {
                balance: userData.balance + parseFloat(amount)
            });

            // Mark code as used
            const usedBy = codeData.usedBy || [];
            usedBy.push(window.currentUserId);
            
            await window.dbUpdate(codeRef, {
                used: usedBy.length >= codeData.maxUses,
                usedBy: usedBy,
                usedCount: usedBy.length
            });

            // Log activity
            logActivity('code_redeemed', `Redeemed code ${code} for $${amount}`);

            showNotification('success', `Successfully redeemed $${amount}!`);
            loadUserData();
            document.getElementById('redeemCode').value = '';
        }

        // Copy Functions
        function copyText(text) {
            navigator.clipboard.writeText(text);
            showNotification('success', 'Copied to clipboard!');
        }

        function copyAmount() {
            const amount = document.getElementById('depositAmountDisplay').value;
            navigator.clipboard.writeText(amount);
            showNotification('success', 'Amount copied!');
        }

        function copyMemo() {
            const memo = document.getElementById('depositMemo').value;
            navigator.clipboard.writeText(memo);
            showNotification('success', 'Memo copied!');
        }

        // Navigation
        function showSection(section) {
            // Hide all sections
            document.querySelectorAll('.main-content').forEach(el => {
                el.classList.remove('active');
            });

            // Remove active from all nav items
            document.querySelectorAll('.nav-item').forEach(el => {
                el.classList.remove('active');
            });

            // Show selected section
            const sectionMap = {
                'trade': 'tradeSection',
                'myTrades': 'myTradesSection',
                'wallet': 'walletSection',
                'referrals': 'referralsSection',
                'tasks': 'tasksSection',
                'profile': 'profileSection'
            };

            document.getElementById(sectionMap[section]).classList.add('active');
            event.currentTarget.classList.add('active');

            // Reset wallet view
            if (section === 'wallet') {
                backToWallet();
            }
        }

        // Notification
        function showNotification(type, message) {
            const notification = document.getElementById('notification');
            const content = document.getElementById('notificationContent');
            
            notification.className = `notification ${type} show`;
            content.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                <span>${message}</span>
            `;

            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            // Load initial data
            setTimeout(() => {
                loadPlans();
            }, 500);
        });
    </script>
</body>
</html>
