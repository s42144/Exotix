<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exotix - Crypto Trading Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #6366f1;
            --secondary-color: #8b5cf6;
            --success-color: #10b981;
            --danger-color: #ef4444;
            --warning-color: #f59e0b;
            --dark-bg: #0f172a;
            --card-bg: #1e293b;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border-color: #334155;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: var(--text-primary);
            min-height: 100vh;
            padding-bottom: 80px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        .header {
            background: var(--card-bg);
            padding: 15px 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .balance-display {
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(99, 102, 241, 0.1);
            padding: 10px 20px;
            border-radius: 10px;
            border: 1px solid var(--primary-color);
        }

        .balance-display img {
            width: 30px;
            height: 30px;
            border-radius: 50%;
        }

        .balance-amount {
            font-size: 18px;
            font-weight: bold;
            color: var(--success-color);
        }

        /* Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--card-bg);
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            box-shadow: 0 -4px 6px rgba(0, 0, 0, 0.3);
            z-index: 1000;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            cursor: pointer;
            padding: 10px 15px;
            border-radius: 10px;
            transition: all 0.3s;
            color: var(--text-secondary);
        }

        .nav-item.active {
            background: rgba(99, 102, 241, 0.2);
            color: var(--primary-color);
        }

        .nav-item i {
            font-size: 20px;
        }

        .nav-item span {
            font-size: 12px;
        }

        /* Sections */
        .section {
            display: none;
        }

        .section.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Trading Plans */
        .plans-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .plan-card {
            background: linear-gradient(135deg, var(--card-bg) 0%, #2d3748 100%);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
            border: 2px solid transparent;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .plan-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
        }

        .plan-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary-color);
            box-shadow: 0 12px 24px rgba(99, 102, 241, 0.3);
        }

        .plan-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .plan-pair {
            font-size: 20px;
            font-weight: bold;
            color: var(--primary-color);
        }

        .plan-badge {
            background: var(--success-color);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
        }

        .plan-chart {
            width: 100%;
            height: 150px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            margin: 15px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .plan-price {
            font-size: 28px;
            font-weight: bold;
            color: var(--success-color);
            text-align: center;
        }

        .price-change {
            font-size: 14px;
            color: var(--success-color);
            text-align: center;
            margin-top: 5px;
        }

        .plan-details {
            margin: 15px 0;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .detail-label {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .detail-value {
            color: var(--text-primary);
            font-weight: bold;
        }

        .buy-button {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 15px;
        }

        .buy-button:hover {
            transform: scale(1.02);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.5);
        }

        .buy-button:disabled {
            background: var(--border-color);
            cursor: not-allowed;
            transform: none;
        }

        /* My Trades */
        .active-trades {
            display: grid;
            gap: 20px;
        }

        .trade-card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
            border-left: 4px solid var(--success-color);
        }

        .trade-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .countdown-timer {
            background: rgba(99, 102, 241, 0.2);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            margin: 15px 0;
        }

        .timer-display {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary-color);
        }

        .progress-bar-3d {
            width: 100%;
            height: 30px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.5);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, var(--success-color), #34d399);
            border-radius: 15px;
            transition: width 1s;
            position: relative;
            box-shadow: 0 2px 8px rgba(16, 185, 129, 0.5);
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 50%;
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.3), transparent);
            border-radius: 15px 15px 0 0;
        }

        .claim-button {
            width: 100%;
            padding: 15px;
            background: var(--success-color);
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 15px;
        }

        .claim-button:disabled {
            background: var(--border-color);
            cursor: not-allowed;
        }

        /* Wallet */
        .wallet-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .wallet-option {
            background: var(--card-bg);
            padding: 30px 20px;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .wallet-option:hover {
            border-color: var(--primary-color);
            transform: translateY(-5px);
        }

        .wallet-option i {
            font-size: 40px;
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .wallet-form {
            background: var(--card-bg);
            padding: 25px;
            border-radius: 15px;
            margin-top: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-secondary);
            font-size: 14px;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 16px;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .qr-section {
            background: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin: 20px 0;
        }

        .qr-section img {
            max-width: 250px;
            margin: 15px auto;
        }

        .copy-field {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .copy-field input {
            flex: 1;
        }

        .copy-btn {
            padding: 12px 20px;
            background: var(--primary-color);
            border: none;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
        }

        .copy-btn:hover {
            background: var(--secondary-color);
        }

        .submit-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .submit-btn:hover {
            transform: scale(1.02);
        }

        /* History Table */
        .history-table {
            background: var(--card-bg);
            border-radius: 15px;
            overflow: hidden;
            margin-top: 20px;
        }

        .history-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .history-table th {
            background: rgba(99, 102, 241, 0.2);
            padding: 15px;
            text-align: left;
            font-weight: bold;
            color: var(--primary-color);
        }

        .history-table td {
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .status-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }

        .status-pending {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning-color);
        }

        .status-approved {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success-color);
        }

        .status-rejected {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger-color);
        }

        /* Referrals */
        .referral-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-card {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            border-left: 4px solid var(--primary-color);
        }

        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: var(--primary-color);
            margin: 10px 0;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .referral-link-box {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
        }

        .share-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .share-btn {
            padding: 15px;
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s;
        }

        .share-btn.telegram {
            background: #0088cc;
        }

        .share-btn.twitter {
            background: #1da1f2;
        }

        .share-btn:hover {
            transform: scale(1.02);
        }

        .referral-list {
            margin-top: 20px;
        }

        .referral-item {
            background: var(--card-bg);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .referral-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .referral-info {
            flex: 1;
        }

        .referral-name {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .referral-earnings {
            color: var(--success-color);
            font-size: 14px;
        }

        /* Tasks */
        .tasks-grid {
            display: grid;
            gap: 15px;
            margin-top: 20px;
        }

        .task-card {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 15px;
            display: flex;
            gap: 15px;
            align-items: center;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .task-card:hover {
            border-color: var(--primary-color);
            transform: translateX(5px);
        }

        .task-icon {
            width: 60px;
            height: 60px;
            border-radius: 10px;
            background: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
        }

        .task-icon img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 10px;
        }

        .task-info {
            flex: 1;
        }

        .task-title {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .task-description {
            color: var(--text-secondary);
            font-size: 14px;
            margin-bottom: 10px;
        }

        .task-reward {
            color: var(--success-color);
            font-weight: bold;
        }

        .task-button {
            padding: 10px 20px;
            background: var(--primary-color);
            border: none;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
        }

        .task-button:hover {
            background: var(--secondary-color);
        }

        .task-button:disabled {
            background: var(--border-color);
            cursor: not-allowed;
        }

        /* Profile */
        .profile-header {
            background: var(--card-bg);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 20px;
        }

        .profile-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            margin: 0 auto 15px;
            background: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            border: 4px solid var(--primary-color);
        }

        .profile-avatar img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
        }

        .profile-name {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .profile-id {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .redeem-section {
            background: var(--card-bg);
            padding: 25px;
            border-radius: 15px;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--card-bg);
            padding: 30px;
            border-radius: 20px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUp 0.3s;
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 24px;
            font-weight: bold;
        }

        .close-modal {
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 24px;
            cursor: pointer;
        }

        /* Notifications */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--card-bg);
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            z-index: 3000;
            animation: slideIn 0.3s;
            border-left: 4px solid var(--success-color);
            max-width: 300px;
        }

        @keyframes slideIn {
            from { transform: translateX(400px); }
            to { transform: translateX(0); }
        }

        .notification.error {
            border-left-color: var(--danger-color);
        }

        .notification.warning {
            border-left-color: var(--warning-color);
        }

        /* Loading */
        .loading {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 4000;
            align-items: center;
            justify-content: center;
        }

        .loading.active {
            display: flex;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid var(--border-color);
            border-top-color: var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .plans-grid {
                grid-template-columns: 1fr;
            }

            .wallet-options {
                grid-template-columns: 1fr;
            }

            .share-buttons {
                grid-template-columns: 1fr;
            }

            .referral-stats {
                grid-template-columns: 1fr;
            }
        }

        .back-button {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            padding: 10px 20px;
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            transition: all 0.3s;
        }

        .back-button:hover {
            background: var(--primary-color);
            border-color: var(--primary-color);
        }

        .section-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 20px;
            color: var(--text-primary);
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
        }

        .empty-state i {
            font-size: 64px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .info-box {
            background: rgba(99, 102, 241, 0.1);
            border: 1px solid var(--primary-color);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
        }

        .info-box i {
            color: var(--primary-color);
            margin-right: 10px;
        }

        .timer-countdown {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid var(--danger-color);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            margin: 15px 0;
        }

        .timer-countdown .time {
            font-size: 24px;
            font-weight: bold;
            color: var(--danger-color);
        }
    </style>
<script src="https://sites.super.myninja.ai/_assets/ninja-daytona-script.js"></script>
</head>
<body>
    <!-- Header -->
    <div class="container">
        <div class="header">
            <div class="logo">
                <i class="fas fa-chart-line"></i> Exotix
            </div>
            <div class="balance-display">
                <img src="https://i.postimg.cc/85tyqGqs/images-6.jpg" alt="USDT">
                <div>
                    <div style="font-size: 12px; color: var(--text-secondary);">Balance</div>
                    <div class="balance-amount" id="userBalance">$0.00</div>
                </div>
            </div>
        </div>

        <!-- Trade Section -->
        <div id="tradeSection" class="section active">
            <h2 class="section-title">Trading Plans</h2>
            <div class="plans-grid" id="plansGrid">
                <!-- Plans will be loaded here -->
            </div>
        </div>

        <!-- My Trades Section -->
        <div id="myTradesSection" class="section">
            <h2 class="section-title">My Active Trades</h2>
            <div class="active-trades" id="activeTrades">
                <!-- Active trades will be loaded here -->
            </div>
        </div>

        <!-- Wallet Section -->
        <div id="walletSection" class="section">
            <h2 class="section-title">Wallet</h2>
            <div class="wallet-options">
                <div class="wallet-option" onclick="showDeposit()">
                    <i class="fas fa-arrow-down"></i>
                    <div>Deposit</div>
                </div>
                <div class="wallet-option" onclick="showWithdraw()">
                    <i class="fas fa-arrow-up"></i>
                    <div>Withdraw</div>
                </div>
                <div class="wallet-option" onclick="showHistory()">
                    <i class="fas fa-history"></i>
                    <div>History</div>
                </div>
                <div class="wallet-option" onclick="showActivities()">
                    <i class="fas fa-list"></i>
                    <div>Activities</div>
                </div>
            </div>
        </div>

        <!-- Deposit Form -->
        <div id="depositForm" class="section">
            <button class="back-button" onclick="showSection('walletSection')">
                <i class="fas fa-arrow-left"></i> Back
            </button>
            <h2 class="section-title">Deposit USDT</h2>
            <div class="wallet-form">
                <div class="info-box">
                    <i class="fas fa-info-circle"></i>
                    Minimum deposit: $30
                </div>
                <div class="form-group">
                    <label>Enter Amount (USD)</label>
                    <input type="number" id="depositAmount" placeholder="Enter amount" min="30">
                </div>
                <button class="submit-btn" onclick="initiateDeposit()">Continue</button>
            </div>
        </div>

        <!-- Deposit Details -->
        <div id="depositDetails" class="section">
            <button class="back-button" onclick="showSection('depositForm')">
                <i class="fas fa-arrow-left"></i> Back
            </button>
            <h2 class="section-title">Complete Deposit</h2>
            
            <div class="timer-countdown">
                <div style="font-size: 14px; margin-bottom: 5px;">Time Remaining</div>
                <div class="time" id="depositTimer">15:00</div>
            </div>

            <div class="qr-section">
                <img src="https://i.postimg.cc/g2mgknm3/Screenshot-2025-10-17-16-28-28-211-com-ton-keeper-edit.jpg" alt="QR Code">
                <div style="color: #000; margin-top: 10px; font-weight: bold;">Scan QR Code to Pay</div>
            </div>

            <div class="wallet-form">
                <div class="form-group">
                    <label>Network</label>
                    <div class="copy-field">
                        <input type="text" value="TON" readonly>
                        <button class="copy-btn" onclick="copyText('TON')">
                            <i class="fas fa-copy"></i>
                        </button>
                    </div>
                </div>

                <div class="form-group">
                    <label>Wallet Address</label>
                    <div class="copy-field">
                        <input type="text" id="depositAddress" value="UQBWOgFgB4B8qBCo8CNjDUNAtvUSosw4v7v9gkt0GVOaNLSz" readonly>
                        <button class="copy-btn" onclick="copyText(document.getElementById('depositAddress').value)">
                            <i class="fas fa-copy"></i>
                        </button>
                    </div>
                </div>

                <div class="form-group">
                    <label>Amount</label>
                    <div class="copy-field">
                        <input type="text" id="depositAmountDisplay" readonly>
                        <button class="copy-btn" onclick="copyText(document.getElementById('depositAmountDisplay').value)">
                            <i class="fas fa-copy"></i>
                        </button>
                    </div>
                </div>

                <div class="form-group">
                    <label>Memo/Comment (Required)</label>
                    <div class="copy-field">
                        <input type="text" id="depositMemo" readonly>
                        <button class="copy-btn" onclick="copyText(document.getElementById('depositMemo').value)">
                            <i class="fas fa-copy"></i>
                        </button>
                    </div>
                </div>

                <div class="info-box">
                    <i class="fas fa-exclamation-triangle"></i>
                    Please include the memo/comment in your transaction. Without it, we cannot identify your deposit.
                </div>

                <div class="form-group">
                    <label>Transaction Hash</label>
                    <input type="text" id="depositTxHash" placeholder="Enter transaction hash">
                </div>

                <button class="submit-btn" onclick="submitDeposit()">Confirm Deposit</button>
            </div>
        </div>

        <!-- Withdraw Form -->
        <div id="withdrawForm" class="section">
            <button class="back-button" onclick="showSection('walletSection')">
                <i class="fas fa-arrow-left"></i> Back
            </button>
            <h2 class="section-title">Withdraw USDT</h2>
            <div class="wallet-form">
                <div class="info-box">
                    <i class="fas fa-info-circle"></i>
                    Minimum withdrawal: $0.10
                </div>
                <div class="form-group">
                    <label>USDT TON Address</label>
                    <input type="text" id="withdrawAddress" placeholder="Enter your USDT TON address">
                </div>
                <div class="form-group">
                    <label>Amount (USD)</label>
                    <input type="number" id="withdrawAmount" placeholder="Enter amount" min="0.10" step="0.01">
                </div>
                <div class="form-group">
                    <label>Memo/Comment (Optional)</label>
                    <input type="text" id="withdrawMemo" placeholder="Enter memo (optional)">
                </div>
                <button class="submit-btn" onclick="submitWithdraw()">Submit Withdrawal</button>
            </div>
        </div>

        <!-- History Section -->
        <div id="historySection" class="section">
            <button class="back-button" onclick="showSection('walletSection')">
                <i class="fas fa-arrow-left"></i> Back
            </button>
            <h2 class="section-title">Transaction History</h2>
            <div class="history-table">
                <table>
                    <thead>
                        <tr>
                            <th>Type</th>
                            <th>Amount</th>
                            <th>Status</th>
                            <th>Date</th>
                        </tr>
                    </thead>
                    <tbody id="historyTableBody">
                        <!-- History will be loaded here -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Activities Section -->
        <div id="activitiesSection" class="section">
            <button class="back-button" onclick="showSection('walletSection')">
                <i class="fas fa-arrow-left"></i> Back
            </button>
            <h2 class="section-title">All Activities</h2>
            <div class="history-table">
                <table>
                    <thead>
                        <tr>
                            <th>Activity</th>
                            <th>Details</th>
                            <th>Date</th>
                        </tr>
                    </thead>
                    <tbody id="activitiesTableBody">
                        <!-- Activities will be loaded here -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Referrals Section -->
        <div id="referralsSection" class="section">
            <h2 class="section-title">Referral Program</h2>
            
            <div class="info-box">
                <i class="fas fa-gift"></i>
                <strong>Earn $0.20</strong> for each referral + <strong>20% commission</strong> on all their deposits and earnings!
            </div>

            <div class="referral-stats">
                <div class="stat-card">
                    <div class="stat-label">Total Referrals</div>
                    <div class="stat-value" id="totalReferrals">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Total Earnings</div>
                    <div class="stat-value" id="totalReferralEarnings">$0.00</div>
                </div>
            </div>

            <div class="referral-link-box">
                <label style="display: block; margin-bottom: 10px; color: var(--text-secondary);">Your Referral Link</label>
                <div class="copy-field">
                    <input type="text" id="referralLink" readonly>
                    <button class="copy-btn" onclick="copyText(document.getElementById('referralLink').value)">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>
            </div>

            <div class="share-buttons">
                <button class="share-btn telegram" onclick="shareOnTelegram()">
                    <i class="fab fa-telegram"></i>
                    Share on Telegram
                </button>
                <button class="share-btn twitter" onclick="shareOnTwitter()">
                    <i class="fab fa-twitter"></i>
                    Share on Twitter
                </button>
            </div>

            <div style="margin-top: 30px;">
                <button class="submit-btn" onclick="showReferralList()">
                    <i class="fas fa-users"></i> View My Referrals
                </button>
            </div>

            <div id="referralListContainer" style="display: none; margin-top: 20px;">
                <h3 style="margin-bottom: 15px;">My Referrals</h3>
                <div class="referral-list" id="referralList">
                    <!-- Referrals will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Tasks Section -->
        <div id="tasksSection" class="section">
            <h2 class="section-title">Complete Tasks & Earn</h2>
            <div class="tasks-grid" id="tasksGrid">
                <!-- Tasks will be loaded here -->
            </div>
        </div>

        <!-- Profile Section -->
        <div id="profileSection" class="section">
            <h2 class="section-title">Profile</h2>
            
            <div class="profile-header">
                <div class="profile-avatar" id="profileAvatar">
                    <i class="fas fa-user"></i>
                </div>
                <div class="profile-name" id="profileName">User</div>
                <div class="profile-id">ID: <span id="profileUserId"></span></div>
            </div>

            <div class="redeem-section">
                <h3 style="margin-bottom: 15px;">Redeem Code</h3>
                <div class="info-box">
                    <i class="fas fa-gift"></i>
                    Enter an 8-digit redemption code to claim your reward!
                </div>
                <div class="form-group">
                    <label>Redemption Code</label>
                    <input type="text" id="redeemCode" placeholder="Enter 8-digit code" maxlength="8">
                </div>
                <button class="submit-btn" onclick="redeemCode()">
                    <i class="fas fa-gift"></i> Redeem Now
                </button>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <div class="bottom-nav">
        <div class="nav-item active" onclick="showSection('tradeSection')">
            <i class="fas fa-chart-line"></i>
            <span>Trade</span>
        </div>
        <div class="nav-item" onclick="showSection('myTradesSection')">
            <i class="fas fa-briefcase"></i>
            <span>My Trades</span>
        </div>
        <div class="nav-item" onclick="showSection('walletSection')">
            <i class="fas fa-wallet"></i>
            <span>Wallet</span>
        </div>
        <div class="nav-item" onclick="showSection('referralsSection')">
            <i class="fas fa-users"></i>
            <span>Referrals</span>
        </div>
        <div class="nav-item" onclick="showSection('tasksSection')">
            <i class="fas fa-tasks"></i>
            <span>Tasks</span>
        </div>
        <div class="nav-item" onclick="showSection('profileSection')">
            <i class="fas fa-user"></i>
            <span>Profile</span>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading" id="loadingOverlay">
        <div class="spinner"></div>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getDatabase, ref, set, get, update, push, onValue, query, orderByChild, equalTo } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';

        const firebaseConfig = {
            apiKey: "AIzaSyBfR97veh6idxb81mH6N5_Gq8-CpW2D7bE",
            authDomain: "jbhigfi.firebaseapp.com",
            databaseURL: "https://jbhigfi-default-rtdb.firebaseio.com",
            projectId: "jbhigfi",
            storageBucket: "jbhigfi.firebasestorage.app",
            messagingSenderId: "736760492095",
            appId: "1:736760492095:web:47b94412495e21c561c88a",
            measurementId: "G-ZZMHC9RTVT"
        };

        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        // Telegram Bot Configuration
        const TELEGRAM_BOT_TOKEN = '7930967027:AAG3AkEZrkKGxTFOyVHwN8VpA9HgusAdRmw';
        const TELEGRAM_API = `https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}`;

        // Global variables
        window.db = database;
        window.dbRef = ref;
        window.dbSet = set;
        window.dbGet = get;
        window.dbUpdate = update;
        window.dbPush = push;
        window.dbOnValue = onValue;
        window.dbQuery = query;
        window.dbOrderByChild = orderByChild;
        window.dbEqualTo = equalTo;

        // Get user ID from Telegram WebApp or generate one
        let userId = 'user_' + Math.random().toString(36).substr(2, 9);
        let userChatId = null;

        // Try to get Telegram user data
        if (window.Telegram && window.Telegram.WebApp) {
            const tg = window.Telegram.WebApp;
            if (tg.initDataUnsafe && tg.initDataUnsafe.user) {
                userId = tg.initDataUnsafe.user.id.toString();
                userChatId = userId;
                document.getElementById('profileName').textContent = tg.initDataUnsafe.user.first_name || 'User';
                if (tg.initDataUnsafe.user.photo_url) {
                    document.getElementById('profileAvatar').innerHTML = `<img src="${tg.initDataUnsafe.user.photo_url}" alt="Avatar">`;
                }
            }
        }

        window.userId = userId;
        window.userChatId = userChatId;
        document.getElementById('profileUserId').textContent = userId;

        // Send Telegram notification
        window.sendTelegramNotification = async function(message) {
            if (!userChatId) return;
            try {
                await fetch(`${TELEGRAM_API}/sendMessage`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        chat_id: userChatId,
                        text: message,
                        parse_mode: 'HTML'
                    })
                });
            } catch (error) {
                console.error('Telegram notification error:', error);
            }
        };

        // Initialize user
        async function initializeUser() {
            const userRef = ref(database, `users/${userId}`);
            const snapshot = await get(userRef);
            
            if (!snapshot.exists()) {
                await set(userRef, {
                    userId: userId,
                    balance: 0,
                    totalDeposits: 0,
                    totalWithdrawals: 0,
                    totalEarnings: 0,
                    referralCode: userId,
                    referredBy: null,
                    referrals: [],
                    referralEarnings: 0,
                    createdAt: Date.now(),
                    hasDeposited: false
                });
            }

            // Listen to balance changes
            onValue(userRef, (snapshot) => {
                if (snapshot.exists()) {
                    const userData = snapshot.val();
                    document.getElementById('userBalance').textContent = '$' + (userData.balance || 0).toFixed(2);
                    window.userData = userData;
                }
            });

            loadPlans();
            loadActiveTrades();
            loadReferralData();
            loadTasks();
        }

        // Trading Plans Data
        const tradingPlans = [
            { pair: 'BTC/USDT', price: 3000, dailyEarning: 300, duration: 30, minInvest: 40 },
            { pair: 'ETH/USDT', price: 2000, dailyEarning: 200, duration: 30, minInvest: 40 },
            { pair: 'BNB/USDT', price: 1500, dailyEarning: 150, duration: 30, minInvest: 40 },
            { pair: 'SOL/USDT', price: 1200, dailyEarning: 120, duration: 30, minInvest: 40 },
            { pair: 'ADA/USDT', price: 1000, dailyEarning: 100, duration: 30, minInvest: 40 },
            { pair: 'DOT/USDT', price: 900, dailyEarning: 90, duration: 30, minInvest: 40 },
            { pair: 'AVAX/USDT', price: 800, dailyEarning: 80, duration: 30, minInvest: 40 },
            { pair: 'MATIC/USDT', price: 700, dailyEarning: 70, duration: 30, minInvest: 40 },
            { pair: 'LINK/USDT', price: 600, dailyEarning: 60, duration: 30, minInvest: 40 },
            { pair: 'UNI/USDT', price: 500, dailyEarning: 50, duration: 30, minInvest: 40 },
            { pair: 'ATOM/USDT', price: 450, dailyEarning: 45, duration: 30, minInvest: 40 },
            { pair: 'XRP/USDT', price: 400, dailyEarning: 40, duration: 30, minInvest: 40 },
            { pair: 'LTC/USDT', price: 350, dailyEarning: 35, duration: 30, minInvest: 40 },
            { pair: 'ALGO/USDT', price: 300, dailyEarning: 30, duration: 30, minInvest: 40 },
            { pair: 'VET/USDT', price: 250, dailyEarning: 25, duration: 30, minInvest: 40 },
            { pair: 'FTM/USDT', price: 200, dailyEarning: 20, duration: 30, minInvest: 40 },
            { pair: 'NEAR/USDT', price: 180, dailyEarning: 18, duration: 30, minInvest: 40 },
            { pair: 'SAND/USDT', price: 150, dailyEarning: 15, duration: 30, minInvest: 40 },
            { pair: 'MANA/USDT', price: 120, dailyEarning: 12, duration: 30, minInvest: 40 },
            { pair: 'DOGE/USDT', price: 100, dailyEarning: 10, duration: 30, minInvest: 40 }
        ];

        // Load trading plans
        async function loadPlans() {
            const plansGrid = document.getElementById('plansGrid');
            plansGrid.innerHTML = '';

            // Get user's purchased plans
            const userTradesRef = ref(database, `trades/${userId}`);
            const tradesSnapshot = await get(userTradesRef);
            const purchasedPlans = tradesSnapshot.exists() ? Object.keys(tradesSnapshot.val()) : [];

            for (let i = 0; i < tradingPlans.length; i++) {
                const plan = tradingPlans[i];
                const planId = `plan_${i}`;
                const isPurchased = purchasedPlans.includes(planId);

                // Simulate price change
                const priceChange = (Math.random() * 10 - 5).toFixed(2);
                const changeClass = priceChange >= 0 ? 'var(--success-color)' : 'var(--danger-color)';

                const planCard = document.createElement('div');
                planCard.className = 'plan-card';
                planCard.innerHTML = `
                    <div class="plan-header">
                        <div class="plan-pair">${plan.pair}</div>
                        <div class="plan-badge">Active</div>
                    </div>
                    <div class="plan-chart">
                        <div>
                            <div class="plan-price">$${plan.price.toFixed(2)}</div>
                            <div class="price-change" style="color: ${changeClass}">
                                ${priceChange >= 0 ? '+' : ''}${priceChange}%
                            </div>
                        </div>
                    </div>
                    <div class="plan-details">
                        <div class="detail-row">
                            <span class="detail-label">Investment</span>
                            <span class="detail-value">$${plan.price.toFixed(2)}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Daily Earning</span>
                            <span class="detail-value" style="color: var(--success-color)">$${plan.dailyEarning.toFixed(2)}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Duration</span>
                            <span class="detail-value">${plan.duration} Days</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Total Return</span>
                            <span class="detail-value" style="color: var(--success-color)">$${(plan.dailyEarning * plan.duration).toFixed(2)}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Min. Investment</span>
                            <span class="detail-value">$${plan.minInvest.toFixed(2)}</span>
                        </div>
                    </div>
                    <button class="buy-button" ${isPurchased ? 'disabled' : ''} onclick="buyPlan('${planId}', ${i})">
                        ${isPurchased ? 'Purchased' : 'Buy Plan'}
                    </button>
                `;
                plansGrid.appendChild(planCard);
            }
        }

        // Buy plan
        window.buyPlan = async function(planId, planIndex) {
            const plan = tradingPlans[planIndex];
            
            if (window.userData.balance < plan.price) {
                showNotification('Insufficient balance!', 'error');
                return;
            }

            showLoading(true);

            try {
                // Deduct balance
                const newBalance = window.userData.balance - plan.price;
                await update(ref(database, `users/${userId}`), {
                    balance: newBalance
                });

                // Create trade
                const tradeData = {
                    planId: planId,
                    pair: plan.pair,
                    investment: plan.price,
                    dailyEarning: plan.dailyEarning,
                    duration: plan.duration,
                    daysRemaining: plan.duration,
                    totalEarned: 0,
                    lastClaimTime: Date.now(),
                    nextClaimTime: Date.now() + (24 * 60 * 60 * 1000),
                    purchaseDate: Date.now(),
                    status: 'active'
                };

                await set(ref(database, `trades/${userId}/${planId}`), tradeData);

                // Add activity
                await push(ref(database, `activities/${userId}`), {
                    type: 'purchase',
                    description: `Purchased ${plan.pair} plan`,
                    amount: plan.price,
                    timestamp: Date.now()
                });

                // Send Telegram notification
                await sendTelegramNotification(
                    `üéâ <b>Plan Purchased Successfully!</b>\n\n` +
                    `üíº Plan: ${plan.pair}\n` +
                    `üí∞ Investment: $${plan.price.toFixed(2)}\n` +
                    `üìà Daily Earning: $${plan.dailyEarning.toFixed(2)}\n` +
                    `‚è± Duration: ${plan.duration} days\n` +
                    `üíµ New Balance: $${newBalance.toFixed(2)}`
                );

                showNotification('Plan purchased successfully!', 'success');
                loadPlans();
                loadActiveTrades();
            } catch (error) {
                console.error('Purchase error:', error);
                showNotification('Purchase failed. Please try again.', 'error');
            }

            showLoading(false);
        };

        // Load active trades
        async function loadActiveTrades() {
            const activeTrades = document.getElementById('activeTrades');
            const tradesRef = ref(database, `trades/${userId}`);
            const snapshot = await get(tradesRef);

            if (!snapshot.exists()) {
                activeTrades.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-briefcase"></i>
                        <p>No active trades yet</p>
                        <p style="font-size: 14px;">Purchase a plan to start earning!</p>
                    </div>
                `;
                return;
            }

            activeTrades.innerHTML = '';
            const trades = snapshot.val();

            for (const [tradeId, trade] of Object.entries(trades)) {
                if (trade.status !== 'active') continue;

                const now = Date.now();
                const canClaim = now >= trade.nextClaimTime;
                const timeUntilClaim = trade.nextClaimTime - now;
                const progress = ((trade.duration - trade.daysRemaining) / trade.duration) * 100;

                const tradeCard = document.createElement('div');
                tradeCard.className = 'trade-card';
                tradeCard.innerHTML = `
                    <div class="trade-header">
                        <div>
                            <div style="font-size: 20px; font-weight: bold; color: var(--primary-color);">${trade.pair}</div>
                            <div style="color: var(--text-secondary); font-size: 14px;">Investment: $${trade.investment.toFixed(2)}</div>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-size: 18px; font-weight: bold; color: var(--success-color);">$${trade.totalEarned.toFixed(2)}</div>
                            <div style="color: var(--text-secondary); font-size: 14px;">Total Earned</div>
                        </div>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Daily Earning</span>
                        <span class="detail-value" style="color: var(--success-color)">$${trade.dailyEarning.toFixed(2)}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Days Remaining</span>
                        <span class="detail-value">${trade.daysRemaining} / ${trade.duration}</span>
                    </div>
                    <div class="countdown-timer">
                        <div style="font-size: 14px; margin-bottom: 5px;">Next Claim In</div>
                        <div class="timer-display" id="timer_${tradeId}">
                            ${canClaim ? 'Ready to Claim!' : formatTime(timeUntilClaim)}
                        </div>
                    </div>
                    <div class="progress-bar-3d">
                        <div class="progress-fill" style="width: ${progress}%"></div>
                    </div>
                    <button class="claim-button" id="claim_${tradeId}" ${!canClaim ? 'disabled' : ''} onclick="claimEarnings('${tradeId}')">
                        ${canClaim ? 'Claim $' + trade.dailyEarning.toFixed(2) : 'Claim Available Soon'}
                    </button>
                `;
                activeTrades.appendChild(tradeCard);

                // Update timer
                if (!canClaim) {
                    setInterval(() => {
                        const remaining = trade.nextClaimTime - Date.now();
                        if (remaining <= 0) {
                            document.getElementById(`timer_${tradeId}`).textContent = 'Ready to Claim!';
                            document.getElementById(`claim_${tradeId}`).disabled = false;
                            document.getElementById(`claim_${tradeId}`).textContent = 'Claim $' + trade.dailyEarning.toFixed(2);
                        } else {
                            document.getElementById(`timer_${tradeId}`).textContent = formatTime(remaining);
                        }
                    }, 1000);
                }
            }
        }

        // Claim earnings
        window.claimEarnings = async function(tradeId) {
            showLoading(true);

            try {
                const tradeRef = ref(database, `trades/${userId}/${tradeId}`);
                const snapshot = await get(tradeRef);
                const trade = snapshot.val();

                const newBalance = window.userData.balance + trade.dailyEarning;
                const newTotalEarned = trade.totalEarned + trade.dailyEarning;
                const newDaysRemaining = trade.daysRemaining - 1;

                // Update balance
                await update(ref(database, `users/${userId}`), {
                    balance: newBalance,
                    totalEarnings: (window.userData.totalEarnings || 0) + trade.dailyEarning
                });

                // Update trade
                if (newDaysRemaining <= 0) {
                    await update(tradeRef, {
                        status: 'completed',
                        totalEarned: newTotalEarned,
                        completedAt: Date.now()
                    });
                } else {
                    await update(tradeRef, {
                        totalEarned: newTotalEarned,
                        daysRemaining: newDaysRemaining,
                        lastClaimTime: Date.now(),
                        nextClaimTime: Date.now() + (24 * 60 * 60 * 1000)
                    });
                }

                // Add activity
                await push(ref(database, `activities/${userId}`), {
                    type: 'claim',
                    description: `Claimed earnings from ${trade.pair}`,
                    amount: trade.dailyEarning,
                    timestamp: Date.now()
                });

                // Send Telegram notification
                await sendTelegramNotification(
                    `üí∞ <b>Earnings Claimed!</b>\n\n` +
                    `üíº Plan: ${trade.pair}\n` +
                    `üíµ Amount: $${trade.dailyEarning.toFixed(2)}\n` +
                    `üìä Total Earned: $${newTotalEarned.toFixed(2)}\n` +
                    `üí≥ New Balance: $${newBalance.toFixed(2)}\n` +
                    `‚è± Days Remaining: ${newDaysRemaining}`
                );

                showNotification('Earnings claimed successfully!', 'success');
                loadActiveTrades();
            } catch (error) {
                console.error('Claim error:', error);
                showNotification('Claim failed. Please try again.', 'error');
            }

            showLoading(false);
        };

        // Format time
        function formatTime(ms) {
            const hours = Math.floor(ms / (1000 * 60 * 60));
            const minutes = Math.floor((ms % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((ms % (1000 * 60)) / 1000);
            return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        // Deposit functions
        window.showDeposit = function() {
            showSection('depositForm');
        };

        window.initiateDeposit = function() {
            const amount = parseFloat(document.getElementById('depositAmount').value);
            
            if (!amount || amount < 30) {
                showNotification('Minimum deposit is $30', 'error');
                return;
            }

            document.getElementById('depositAmountDisplay').value = '$' + amount.toFixed(2);
            document.getElementById('depositMemo').value = `ExotixDP_${userId}`;
            
            // Start 15-minute timer
            let timeLeft = 15 * 60;
            const timerInterval = setInterval(() => {
                timeLeft--;
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                document.getElementById('depositTimer').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    showNotification('Deposit time expired. Please try again.', 'warning');
                    showSection('depositForm');
                }
            }, 1000);

            showSection('depositDetails');
        };

        window.submitDeposit = async function() {
            const amount = parseFloat(document.getElementById('depositAmountDisplay').value.replace('$', ''));
            const txHash = document.getElementById('depositTxHash').value.trim();

            if (!txHash) {
                showNotification('Please enter transaction hash', 'error');
                return;
            }

            showLoading(true);

            try {
                const depositData = {
                    userId: userId,
                    amount: amount,
                    txHash: txHash,
                    address: 'UQBWOgFgB4B8qBCo8CNjDUNAtvUSosw4v7v9gkt0GVOaNLSz',
                    memo: `ExotixDP_${userId}`,
                    network: 'TON',
                    status: 'pending',
                    timestamp: Date.now()
                };

                await push(ref(database, `deposits`), depositData);
                await push(ref(database, `activities/${userId}`), {
                    type: 'deposit',
                    description: 'Deposit request submitted',
                    amount: amount,
                    timestamp: Date.now()
                });

                showNotification('Deposit submitted! Waiting for approval.', 'success');
                showSection('walletSection');
                document.getElementById('depositAmount').value = '';
                document.getElementById('depositTxHash').value = '';
            } catch (error) {
                console.error('Deposit error:', error);
                showNotification('Deposit submission failed. Please try again.', 'error');
            }

            showLoading(false);
        };

        // Withdraw functions
        window.showWithdraw = function() {
            if (!window.userData.hasDeposited) {
                showNotification('First time deposit required to withdraw', 'warning');
                return;
            }
            showSection('withdrawForm');
        };

        window.submitWithdraw = async function() {
            const address = document.getElementById('withdrawAddress').value.trim();
            const amount = parseFloat(document.getElementById('withdrawAmount').value);
            const memo = document.getElementById('withdrawMemo').value.trim();

            if (!address) {
                showNotification('Please enter withdrawal address', 'error');
                return;
            }

            if (!amount || amount < 0.10) {
                showNotification('Minimum withdrawal is $0.10', 'error');
                return;
            }

            if (amount > window.userData.balance) {
                showNotification('Insufficient balance', 'error');
                return;
            }

            showLoading(true);

            try {
                const withdrawData = {
                    userId: userId,
                    amount: amount,
                    address: address,
                    memo: memo,
                    network: 'TON',
                    status: 'pending',
                    timestamp: Date.now()
                };

                await push(ref(database, `withdrawals`), withdrawData);
                await push(ref(database, `activities/${userId}`), {
                    type: 'withdrawal',
                    description: 'Withdrawal request submitted',
                    amount: amount,
                    timestamp: Date.now()
                });

                showNotification('Withdrawal submitted! Waiting for approval.', 'success');
                showSection('walletSection');
                document.getElementById('withdrawAddress').value = '';
                document.getElementById('withdrawAmount').value = '';
                document.getElementById('withdrawMemo').value = '';
            } catch (error) {
                console.error('Withdrawal error:', error);
                showNotification('Withdrawal submission failed. Please try again.', 'error');
            }

            showLoading(false);
        };

        // History functions
        window.showHistory = async function() {
            showSection('historySection');
            const tbody = document.getElementById('historyTableBody');
            tbody.innerHTML = '<tr><td colspan="4" style="text-align: center;">Loading...</td></tr>';

            try {
                // Load deposits
                const depositsRef = query(ref(database, 'deposits'), orderByChild('userId'), equalTo(userId));
                const depositsSnapshot = await get(depositsRef);
                
                // Load withdrawals
                const withdrawalsRef = query(ref(database, 'withdrawals'), orderByChild('userId'), equalTo(userId));
                const withdrawalsSnapshot = await get(withdrawalsRef);

                const transactions = [];

                if (depositsSnapshot.exists()) {
                    Object.values(depositsSnapshot.val()).forEach(deposit => {
                        transactions.push({
                            type: 'Deposit',
                            amount: deposit.amount,
                            status: deposit.status,
                            timestamp: deposit.timestamp
                        });
                    });
                }

                if (withdrawalsSnapshot.exists()) {
                    Object.values(withdrawalsSnapshot.val()).forEach(withdrawal => {
                        transactions.push({
                            type: 'Withdrawal',
                            amount: withdrawal.amount,
                            status: withdrawal.status,
                            timestamp: withdrawal.timestamp
                        });
                    });
                }

                transactions.sort((a, b) => b.timestamp - a.timestamp);

                if (transactions.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="4" style="text-align: center;">No transactions yet</td></tr>';
                    return;
                }

                tbody.innerHTML = transactions.map(tx => `
                    <tr>
                        <td>${tx.type}</td>
                        <td>$${tx.amount.toFixed(2)}</td>
                        <td><span class="status-badge status-${tx.status}">${tx.status}</span></td>
                        <td>${new Date(tx.timestamp).toLocaleString()}</td>
                    </tr>
                `).join('');
            } catch (error) {
                console.error('History error:', error);
                tbody.innerHTML = '<tr><td colspan="4" style="text-align: center;">Error loading history</td></tr>';
            }
        };

        // Activities function
        window.showActivities = async function() {
            showSection('activitiesSection');
            const tbody = document.getElementById('activitiesTableBody');
            tbody.innerHTML = '<tr><td colspan="3" style="text-align: center;">Loading...</td></tr>';

            try {
                const activitiesRef = ref(database, `activities/${userId}`);
                const snapshot = await get(activitiesRef);

                if (!snapshot.exists()) {
                    tbody.innerHTML = '<tr><td colspan="3" style="text-align: center;">No activities yet</td></tr>';
                    return;
                }

                const activities = Object.values(snapshot.val()).sort((a, b) => b.timestamp - a.timestamp);

                tbody.innerHTML = activities.map(activity => `
                    <tr>
                        <td>${activity.type}</td>
                        <td>${activity.description}</td>
                        <td>${new Date(activity.timestamp).toLocaleString()}</td>
                    </tr>
                `).join('');
            } catch (error) {
                console.error('Activities error:', error);
                tbody.innerHTML = '<tr><td colspan="3" style="text-align: center;">Error loading activities</td></tr>';
            }
        };

        // Referral functions
        async function loadReferralData() {
            const referralLink = `http://t.me/Exotix_Robot/myapp?start=${userId}`;
            document.getElementById('referralLink').value = referralLink;

            const userRef = ref(database, `users/${userId}`);
            onValue(userRef, (snapshot) => {
                if (snapshot.exists()) {
                    const data = snapshot.val();
                    document.getElementById('totalReferrals').textContent = (data.referrals || []).length;
                    document.getElementById('totalReferralEarnings').textContent = '$' + (data.referralEarnings || 0).toFixed(2);
                }
            });
        }

        window.shareOnTelegram = function() {
            const referralLink = document.getElementById('referralLink').value;
            const text = `üéÅ Join Exotix Trading Platform!\n\nüí∞ Earn $0.20 for signing up\nüìà Get 20% commission on all deposits and earnings\n\n${referralLink}`;
            window.open(`https://t.me/share/url?url=${encodeURIComponent(referralLink)}&text=${encodeURIComponent(text)}`, '_blank');
        };

        window.shareOnTwitter = function() {
            const referralLink = document.getElementById('referralLink').value;
            const text = `üéÅ Join Exotix Trading Platform! Earn $0.20 for signing up + 20% commission on all deposits and earnings! ${referralLink}`;
            window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}`, '_blank');
        };

        window.showReferralList = async function() {
            const container = document.getElementById('referralListContainer');
            const list = document.getElementById('referralList');
            
            container.style.display = 'block';
            list.innerHTML = '<div style="text-align: center; padding: 20px;">Loading...</div>';

            try {
                const userRef = ref(database, `users/${userId}`);
                const snapshot = await get(userRef);
                
                if (!snapshot.exists() || !snapshot.val().referrals || snapshot.val().referrals.length === 0) {
                    list.innerHTML = '<div class="empty-state"><i class="fas fa-users"></i><p>No referrals yet</p></div>';
                    return;
                }

                const referrals = snapshot.val().referrals;
                list.innerHTML = '';

                for (const refId of referrals) {
                    const refUserRef = ref(database, `users/${refId}`);
                    const refSnapshot = await get(refUserRef);
                    
                    if (refSnapshot.exists()) {
                        const refData = refSnapshot.val();
                        const earnings = (refData.totalDeposits || 0) * 0.2 + 0.20;
                        
                        const item = document.createElement('div');
                        item.className = 'referral-item';
                        item.innerHTML = `
                            <div class="referral-avatar">
                                <i class="fas fa-user"></i>
                            </div>
                            <div class="referral-info">
                                <div class="referral-name">User ${refId.substr(0, 8)}</div>
                                <div class="referral-earnings">Balance: $${(refData.balance || 0).toFixed(2)}</div>
                            </div>
                            <div style="text-align: right;">
                                <div style="font-weight: bold; color: var(--success-color);">+$${earnings.toFixed(2)}</div>
                                <div style="font-size: 12px; color: var(--text-secondary);">Your Earnings</div>
                            </div>
                        `;
                        list.appendChild(item);
                    }
                }
            } catch (error) {
                console.error('Referral list error:', error);
                list.innerHTML = '<div style="text-align: center; padding: 20px; color: var(--danger-color);">Error loading referrals</div>';
            }
        };

        // Tasks functions
        async function loadTasks() {
            const tasksGrid = document.getElementById('tasksGrid');
            tasksGrid.innerHTML = '<div style="text-align: center; padding: 40px;">Loading tasks...</div>';

            try {
                const tasksRef = ref(database, 'tasks');
                const snapshot = await get(tasksRef);

                if (!snapshot.exists()) {
                    tasksGrid.innerHTML = '<div class="empty-state"><i class="fas fa-tasks"></i><p>No tasks available</p></div>';
                    return;
                }

                const tasks = snapshot.val();
                const userTasksRef = ref(database, `userTasks/${userId}`);
                const userTasksSnapshot = await get(userTasksRef);
                const completedTasks = userTasksSnapshot.exists() ? Object.keys(userTasksSnapshot.val()) : [];

                tasksGrid.innerHTML = '';

                for (const [taskId, task] of Object.entries(tasks)) {
                    const isCompleted = completedTasks.includes(taskId);
                    
                    const taskCard = document.createElement('div');
                    taskCard.className = 'task-card';
                    taskCard.innerHTML = `
                        <div class="task-icon">
                            ${task.logo ? `<img src="${task.logo}" alt="Task">` : '<i class="fas fa-tasks"></i>'}
                        </div>
                        <div class="task-info">
                            <div class="task-title">${task.title}</div>
                            <div class="task-description">${task.description}</div>
                            <div class="task-reward">Reward: $${task.reward.toFixed(2)}</div>
                        </div>
                        <button class="task-button" ${isCompleted ? 'disabled' : ''} onclick="completeTask('${taskId}', '${task.link}', ${task.reward})">
                            ${isCompleted ? 'Completed' : 'Start Task'}
                        </button>
                    `;
                    tasksGrid.appendChild(taskCard);
                }
            } catch (error) {
                console.error('Tasks error:', error);
                tasksGrid.innerHTML = '<div style="text-align: center; padding: 40px; color: var(--danger-color);">Error loading tasks</div>';
            }
        }

        window.completeTask = async function(taskId, link, reward) {
            window.open(link, '_blank');
            
            setTimeout(async () => {
                showLoading(true);

                try {
                    const newBalance = window.userData.balance + reward;
                    await update(ref(database, `users/${userId}`), {
                        balance: newBalance
                    });

                    await set(ref(database, `userTasks/${userId}/${taskId}`), {
                        completedAt: Date.now(),
                        reward: reward
                    });

                    await push(ref(database, `activities/${userId}`), {
                        type: 'task',
                        description: 'Completed task',
                        amount: reward,
                        timestamp: Date.now()
                    });

                    await sendTelegramNotification(
                        `‚úÖ <b>Task Completed!</b>\n\n` +
                        `üí∞ Reward: $${reward.toFixed(2)}\n` +
                        `üíµ New Balance: $${newBalance.toFixed(2)}`
                    );

                    showNotification('Task completed! Reward added to balance.', 'success');
                    loadTasks();
                } catch (error) {
                    console.error('Task completion error:', error);
                    showNotification('Task completion failed. Please try again.', 'error');
                }

                showLoading(false);
            }, 5000);
        };

        // Redeem code
        window.redeemCode = async function() {
            const code = document.getElementById('redeemCode').value.trim();
            
            if (code.length !== 8) {
                showNotification('Please enter a valid 8-digit code', 'error');
                return;
            }

            showLoading(true);

            try {
                const codesRef = ref(database, 'redeemCodes');
                const snapshot = await get(codesRef);

                if (!snapshot.exists()) {
                    showNotification('Invalid redemption code', 'error');
                    showLoading(false);
                    return;
                }

                const codes = snapshot.val();
                let codeData = null;
                let codeKey = null;

                for (const [key, data] of Object.entries(codes)) {
                    if (data.code === code && !data.used) {
                        codeData = data;
                        codeKey = key;
                        break;
                    }
                }

                if (!codeData) {
                    showNotification('Invalid or already used code', 'error');
                    showLoading(false);
                    return;
                }

                const reward = codeData.amount;
                const newBalance = window.userData.balance + reward;

                await update(ref(database, `users/${userId}`), {
                    balance: newBalance
                });

                await update(ref(database, `redeemCodes/${codeKey}`), {
                    used: true,
                    usedBy: userId,
                    usedAt: Date.now()
                });

                await push(ref(database, `activities/${userId}`), {
                    type: 'redeem',
                    description: 'Redeemed code',
                    amount: reward,
                    timestamp: Date.now()
                });

                await sendTelegramNotification(
                    `üéÅ <b>Code Redeemed!</b>\n\n` +
                    `üí∞ Reward: $${reward.toFixed(2)}\n` +
                    `üíµ New Balance: $${newBalance.toFixed(2)}`
                );

                showNotification(`Code redeemed! You received $${reward.toFixed(2)}`, 'success');
                document.getElementById('redeemCode').value = '';
            } catch (error) {
                console.error('Redeem error:', error);
                showNotification('Redemption failed. Please try again.', 'error');
            }

            showLoading(false);
        };

        // Utility functions
        window.showSection = function(sectionId) {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(sectionId).classList.add('active');

            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });

            const navMap = {
                'tradeSection': 0,
                'myTradesSection': 1,
                'walletSection': 2,
                'referralsSection': 3,
                'tasksSection': 4,
                'profileSection': 5
            };

            if (navMap[sectionId] !== undefined) {
                document.querySelectorAll('.nav-item')[navMap[sectionId]].classList.add('active');
            }
        };

        window.copyText = function(text) {
            navigator.clipboard.writeText(text).then(() => {
                showNotification('Copied to clipboard!', 'success');
            });
        };

        window.showNotification = function(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 3000);
        };

        window.showLoading = function(show) {
            document.getElementById('loadingOverlay').classList.toggle('active', show);
        };

        // Initialize
        initializeUser();
    </script>
</body>
</html>
