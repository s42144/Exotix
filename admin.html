<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Exotix Admin Panel</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  
  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    :root {
      --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --success-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      --danger-gradient: linear-gradient(135deg, #ff4444 0%, #cc0000 100%);
      --warning-gradient: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
      --dark-bg: #0f0c29;
      --card-bg: rgba(255, 255, 255, 0.08);
      --card-border: rgba(255, 255, 255, 0.15);
      --text-primary: #ffffff;
      --text-secondary: #b8c5d6;
      --accent-cyan: #00f2fe;
      --accent-green: #00ff88;
      --accent-red: #ff4444;
      --accent-gold: #ffd700;
    }
    
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);
      color: var(--text-primary);
      min-height: 100vh;
    }
    
    .admin-header {
      background: rgba(15, 12, 41, 0.95);
      backdrop-filter: blur(20px);
      padding: 20px 40px;
      border-bottom: 1px solid var(--card-border);
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: sticky;
      top: 0;
      z-index: 1000;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
    }
    
    .admin-logo {
      font-size: 28px;
      font-weight: 800;
      background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      letter-spacing: 2px;
    }
    
    .admin-stats-header {
      display: flex;
      gap: 30px;
      align-items: center;
    }
    
    .header-stat {
      text-align: center;
    }
    
    .header-stat-label {
      font-size: 11px;
      color: var(--text-secondary);
      font-weight: 600;
      text-transform: uppercase;
      margin-bottom: 4px;
    }
    
    .header-stat-value {
      font-size: 20px;
      font-weight: 800;
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .admin-container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 40px 20px;
    }
    
    .admin-tabs {
      display: flex;
      gap: 12px;
      margin-bottom: 30px;
      flex-wrap: wrap;
    }
    
    .admin-tab-btn {
      padding: 12px 24px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid var(--card-border);
      border-radius: 12px;
      font-size: 14px;
      font-weight: 700;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .admin-tab-btn:hover {
      background: rgba(255, 255, 255, 0.1);
    }
    
    .admin-tab-btn.active {
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      color: #fff;
      border-color: transparent;
    }
    
    .admin-content {
      background: var(--card-bg);
      backdrop-filter: blur(20px);
      border-radius: 20px;
      padding: 30px;
      border: 1px solid var(--card-border);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
    }
    
    .section-title {
      font-size: 24px;
      font-weight: 800;
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 20px;
    }
    
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .stat-card {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 16px;
      padding: 24px;
      border: 1px solid var(--card-border);
      text-align: center;
    }
    
    .stat-icon {
      font-size: 40px;
      margin-bottom: 12px;
    }
    
    .stat-value {
      font-size: 32px;
      font-weight: 800;
      color: var(--accent-cyan);
      margin-bottom: 8px;
    }
    
    .stat-label {
      font-size: 13px;
      color: var(--text-secondary);
      font-weight: 600;
      text-transform: uppercase;
    }
    
    .chart-container {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 16px;
      padding: 24px;
      margin-bottom: 30px;
      border: 1px solid var(--card-border);
    }
    
    .chart-title {
      font-size: 18px;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 20px;
    }
    
    .table-container {
      overflow-x: auto;
      margin-bottom: 20px;
    }
    
    .admin-table {
      width: 100%;
      border-collapse: collapse;
    }
    
    .admin-table th {
      background: rgba(255, 255, 255, 0.1);
      padding: 16px;
      text-align: left;
      font-size: 13px;
      font-weight: 700;
      color: var(--text-primary);
      text-transform: uppercase;
      border-bottom: 2px solid var(--card-border);
    }
    
    .admin-table td {
      padding: 16px;
      border-bottom: 1px solid var(--card-border);
      font-size: 14px;
      color: var(--text-secondary);
    }
    
    .admin-table tr:hover {
      background: rgba(255, 255, 255, 0.05);
    }
    
    .status-badge {
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 11px;
      font-weight: 700;
      text-transform: uppercase;
      display: inline-block;
    }
    
    .status-pending {
      background: rgba(255, 215, 0, 0.2);
      color: var(--accent-gold);
    }
    
    .status-approved {
      background: rgba(0, 255, 136, 0.2);
      color: var(--accent-green);
    }
    
    .status-rejected {
      background: rgba(255, 68, 68, 0.2);
      color: var(--accent-red);
    }
    
    .action-btn {
      padding: 8px 16px;
      border: none;
      border-radius: 8px;
      font-size: 12px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      text-transform: uppercase;
      margin-right: 8px;
    }
    
    .btn-approve {
      background: linear-gradient(135deg, #00ff88 0%, #00cc6a 100%);
      color: #fff;
    }
    
    .btn-reject {
      background: linear-gradient(135deg, #ff4444 0%, #cc0000 100%);
      color: #fff;
    }
    
    .btn-view {
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      color: #fff;
    }
    
    .btn-delete {
      background: linear-gradient(135deg, #ff4444 0%, #cc0000 100%);
      color: #fff;
    }
    
    .action-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }
    
    .form-group {
      margin-bottom: 20px;
    }
    
    .form-label {
      font-size: 13px;
      color: var(--text-secondary);
      font-weight: 600;
      margin-bottom: 8px;
      display: block;
    }
    
    .form-input {
      width: 100%;
      padding: 12px 16px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid var(--card-border);
      border-radius: 10px;
      font-size: 14px;
      color: var(--text-primary);
      font-family: 'Poppins', sans-serif;
      outline: none;
      transition: all 0.3s ease;
    }
    
    .form-input:focus {
      border-color: var(--accent-cyan);
      background: rgba(255, 255, 255, 0.08);
    }
    
    .form-select {
      width: 100%;
      padding: 12px 16px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid var(--card-border);
      border-radius: 10px;
      font-size: 14px;
      color: var(--text-primary);
      font-family: 'Poppins', sans-serif;
      outline: none;
      cursor: pointer;
    }
    
    .btn-primary {
      padding: 14px 32px;
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 700;
      color: #fff;
      cursor: pointer;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(79, 172, 254, 0.4);
    }
    
    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      color: #fff;
      padding: 16px 24px;
      border-radius: 12px;
      font-size: 14px;
      font-weight: 600;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
      z-index: 10000;
      animation: slideIn 0.3s ease;
    }
    
    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateX(100px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }
    
    .notification.success {
      background: linear-gradient(135deg, #00ff88 0%, #00cc6a 100%);
    }
    
    .notification.error {
      background: linear-gradient(135deg, #ff4444 0%, #cc0000 100%);
    }
    
    .empty-state {
      text-align: center;
      padding: 60px 20px;
    }
    
    .empty-icon {
      font-size: 64px;
      margin-bottom: 16px;
      opacity: 0.5;
    }
    
    .empty-text {
      font-size: 16px;
      color: var(--text-secondary);
    }
    
    .user-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: 2px solid var(--accent-cyan);
      object-fit: cover;
    }
    
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 0, 0.8);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      padding: 20px;
    }
    
    .modal-content {
      background: linear-gradient(135deg, #0f0c29 0%, #302b63 100%);
      border-radius: 24px;
      padding: 30px;
      max-width: 600px;
      width: 100%;
      max-height: 80vh;
      overflow-y: auto;
      border: 1px solid var(--card-border);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    }
    
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    
    .modal-title {
      font-size: 24px;
      font-weight: 800;
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .modal-close {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.1);
      border: none;
      color: var(--text-primary);
      font-size: 20px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }
    
    .modal-close:hover {
      background: rgba(255, 255, 255, 0.2);
    }
    
    .detail-row {
      display: flex;
      justify-content: space-between;
      padding: 12px 0;
      border-bottom: 1px solid var(--card-border);
    }
    
    .detail-label {
      font-size: 14px;
      color: var(--text-secondary);
      font-weight: 600;
    }
    
    .detail-value {
      font-size: 14px;
      color: var(--text-primary);
      font-weight: 600;
      text-align: right;
    }
    
    .search-box {
      margin-bottom: 20px;
    }
    
    .search-input {
      width: 100%;
      padding: 12px 16px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid var(--card-border);
      border-radius: 10px;
      font-size: 14px;
      color: var(--text-primary);
      font-family: 'Poppins', sans-serif;
      outline: none;
    }
    
    .filter-group {
      display: flex;
      gap: 12px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    
    .filter-btn {
      padding: 8px 16px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid var(--card-border);
      border-radius: 8px;
      font-size: 12px;
      font-weight: 600;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .filter-btn.active {
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      color: #fff;
      border-color: transparent;
    }
  </style>
<script src="https://sites.super.myninja.ai/_assets/ninja-daytona-script.js"></script>
</head>
<body>
  <!-- Admin Header -->
  <div class="admin-header">
    <div class="admin-logo">EXOTIX ADMIN</div>
    <div class="admin-stats-header">
      <div class="header-stat">
        <div class="header-stat-label">Total Users</div>
        <div class="header-stat-value" id="headerTotalUsers">0</div>
      </div>
      <div class="header-stat">
        <div class="header-stat-label">Total Balance</div>
        <div class="header-stat-value" id="headerTotalBalance">$0</div>
      </div>
      <div class="header-stat">
        <div class="header-stat-label">Active Trades</div>
        <div class="header-stat-value" id="headerActiveTrades">0</div>
      </div>
      <div class="header-stat">
        <div class="header-stat-label">Pending Actions</div>
        <div class="header-stat-value" id="headerPendingActions">0</div>
      </div>
    </div>
  </div>
  
  <!-- Admin Container -->
  <div class="admin-container">
    <!-- Admin Tabs -->
    <div class="admin-tabs">
      <button class="admin-tab-btn active" onclick="showAdminTab('dashboard')">Dashboard</button>
      <button class="admin-tab-btn" onclick="showAdminTab('deposits')">Deposits</button>
      <button class="admin-tab-btn" onclick="showAdminTab('withdrawals')">Withdrawals</button>
      <button class="admin-tab-btn" onclick="showAdminTab('users')">Users</button>
      <button class="admin-tab-btn" onclick="showAdminTab('trades')">Trades</button>
      <button class="admin-tab-btn" onclick="showAdminTab('redemption')">Redemption Codes</button>
      <button class="admin-tab-btn" onclick="showAdminTab('analytics')">Analytics</button>
      <button class="admin-tab-btn" onclick="showAdminTab('settings')">Settings</button>
    </div>
    
    <!-- Admin Content -->
    <div class="admin-content" id="adminContent"></div>
  </div>
  
  <!-- Modals -->
  <div class="modal-overlay" id="detailModal">
    <div class="modal-content">
      <div class="modal-header">
        <div class="modal-title" id="modalTitle">Details</div>
        <button class="modal-close" onclick="closeModal('detailModal')">×</button>
      </div>
      <div id="modalContent"></div>
    </div>
  </div>
  
  <script>
    // Firebase Configuration
    const firebaseConfig = {
      apiKey: "AIzaSyBfR97veh6idxb81mH6N5_Gq8-CpW2D7bE",
      authDomain: "jbhigfi.firebaseapp.com",
      databaseURL: "https://jbhigfi-default-rtdb.firebaseio.com",
      projectId: "jbhigfi",
      storageBucket: "jbhigfi.firebasestorage.app",
      messagingSenderId: "736760492095",
      appId: "1:736760492095:web:47b94412495e21c561c88a",
      measurementId: "G-ZZMHC9RTVT"
    };
    
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    
    // Telegram Bot API
    const BOT_TOKEN = '8237387201:AAFI98932KS3M5uJDLaTbu27FCFOJ40wwxI';
    const TELEGRAM_API = `https://api.telegram.org/bot${BOT_TOKEN}`;
    
    // Global State
    let allUsers = {};
    let pendingDeposits = {};
    let pendingWithdrawals = {};
    let redemptionCodes = {};
    let adminStats = {
      totalUsers: 0,
      totalBalance: 0,
      activeTrades: 0,
      pendingActions: 0
    };
    
    // Utility Functions
    function now() {
      return Math.floor(Date.now() / 1000);
    }
    
    function formatDate(timestamp) {
      const date = new Date(timestamp * 1000);
      return date.toLocaleString();
    }
    
    function notify(message, type = 'info', duration = 3000) {
      const notification = document.createElement('div');
      notification.className = `notification ${type}`;
      notification.textContent = message;
      document.body.appendChild(notification);
      
      setTimeout(() => {
        notification.remove();
      }, duration);
    }
    
    // Send Telegram Notification
    async function sendTelegramNotification(userId, message) {
      try {
        await fetch(`${TELEGRAM_API}/sendMessage`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            chat_id: userId,
            text: message,
            parse_mode: 'HTML'
          })
        });
      } catch (error) {
        console.error('Error sending Telegram notification:', error);
      }
    }
    
    // Load All Data
    function loadAllData() {
      // Load users
      db.ref('users').on('value', (snapshot) => {
        allUsers = snapshot.val() || {};
        updateHeaderStats();
      });
      
      // Load pending deposits
      db.ref('admin/pendingDeposits').on('value', (snapshot) => {
        pendingDeposits = snapshot.val() || {};
        updateHeaderStats();
      });
      
      // Load pending withdrawals
      db.ref('admin/pendingWithdrawals').on('value', (snapshot) => {
        pendingWithdrawals = snapshot.val() || {};
        updateHeaderStats();
      });
      
      // Load redemption codes
      db.ref('redemptionCodes').on('value', (snapshot) => {
        redemptionCodes = snapshot.val() || {};
      });
    }
    
    // Update Header Stats
    function updateHeaderStats() {
      const userKeys = Object.keys(allUsers);
      let totalBalance = 0;
      let activeTrades = 0;
      
      userKeys.forEach(userId => {
        const user = allUsers[userId];
        totalBalance += user.balance || 0;
        if (user.trades) {
          activeTrades += Object.keys(user.trades).length;
        }
      });
      
      const pendingActions = Object.keys(pendingDeposits).length + Object.keys(pendingWithdrawals).length;
      
      adminStats = {
        totalUsers: userKeys.length,
        totalBalance: totalBalance,
        activeTrades: activeTrades,
        pendingActions: pendingActions
      };
      
      document.getElementById('headerTotalUsers').textContent = adminStats.totalUsers;
      document.getElementById('headerTotalBalance').textContent = '$' + adminStats.totalBalance.toFixed(2);
      document.getElementById('headerActiveTrades').textContent = adminStats.activeTrades;
      document.getElementById('headerPendingActions').textContent = adminStats.pendingActions;
    }
    
    // Navigation
    function showAdminTab(tab) {
      document.querySelectorAll('.admin-tab-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      event.target.classList.add('active');
      
      if (tab === 'dashboard') renderDashboard();
      if (tab === 'deposits') renderDeposits();
      if (tab === 'withdrawals') renderWithdrawals();
      if (tab === 'users') renderUsers();
      if (tab === 'trades') renderTrades();
      if (tab === 'redemption') renderRedemption();
      if (tab === 'analytics') renderAnalytics();
      if (tab === 'settings') renderSettings();
    }
    
    // Dashboard
    function renderDashboard() {
      // Calculate stats
      const userKeys = Object.keys(allUsers);
      let totalDeposits = 0;
      let totalWithdrawals = 0;
      let totalTradeInvestments = 0;
      let totalTradeClaims = 0;
      
      userKeys.forEach(userId => {
        const user = allUsers[userId];
        
        if (user.transactions) {
          Object.keys(user.transactions).forEach(txId => {
            const tx = user.transactions[txId];
            if (tx.type === 'deposit' && tx.status === 'approved') {
              totalDeposits += tx.amount;
            }
            if (tx.type === 'withdraw' && tx.status === 'approved') {
              totalWithdrawals += tx.amount;
            }
          });
        }
        
        if (user.trades) {
          Object.keys(user.trades).forEach(pair => {
            const trade = user.trades[pair];
            totalTradeInvestments += trade.investment;
            totalTradeClaims += trade.totalClaimed;
          });
        }
      });
      
      const html = `
        <div class="section-title">Dashboard Overview</div>
        
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-icon">👥</div>
            <div class="stat-value">${adminStats.totalUsers}</div>
            <div class="stat-label">Total Users</div>
          </div>
          
          <div class="stat-card">
            <div class="stat-icon">💰</div>
            <div class="stat-value">$${adminStats.totalBalance.toFixed(2)}</div>
            <div class="stat-label">Total Balance</div>
          </div>
          
          <div class="stat-card">
            <div class="stat-icon">📈</div>
            <div class="stat-value">${adminStats.activeTrades}</div>
            <div class="stat-label">Active Trades</div>
          </div>
          
          <div class="stat-card">
            <div class="stat-icon">⏳</div>
            <div class="stat-value">${adminStats.pendingActions}</div>
            <div class="stat-label">Pending Actions</div>
          </div>
          
          <div class="stat-card">
            <div class="stat-icon">💵</div>
            <div class="stat-value">$${totalDeposits.toFixed(2)}</div>
            <div class="stat-label">Total Deposits</div>
          </div>
          
          <div class="stat-card">
            <div class="stat-icon">💸</div>
            <div class="stat-value">$${totalWithdrawals.toFixed(2)}</div>
            <div class="stat-label">Total Withdrawals</div>
          </div>
          
          <div class="stat-card">
            <div class="stat-icon">📊</div>
            <div class="stat-value">$${totalTradeInvestments.toFixed(2)}</div>
            <div class="stat-label">Trade Investments</div>
          </div>
          
          <div class="stat-card">
            <div class="stat-icon">💎</div>
            <div class="stat-value">$${totalTradeClaims.toFixed(2)}</div>
            <div class="stat-label">Trade Claims</div>
          </div>
        </div>
        
        <div class="chart-container">
          <div class="chart-title">User Growth (Last 30 Days)</div>
          <canvas id="userGrowthChart" width="400" height="200"></canvas>
        </div>
        
        <div class="chart-container">
          <div class="chart-title">Revenue Overview</div>
          <canvas id="revenueChart" width="400" height="200"></canvas>
        </div>
      `;
      
      document.getElementById('adminContent').innerHTML = html;
      
      // Render charts
      setTimeout(() => {
        renderUserGrowthChart();
        renderRevenueChart(totalDeposits, totalWithdrawals, totalTradeInvestments, totalTradeClaims);
      }, 100);
    }
    
    function renderUserGrowthChart() {
      const ctx = document.getElementById('userGrowthChart');
      if (!ctx) return;
      
      // Generate mock data for last 30 days
      const labels = [];
      const data = [];
      const today = new Date();
      
      for (let i = 29; i >= 0; i--) {
        const date = new Date(today);
        date.setDate(date.getDate() - i);
        labels.push(date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }));
        data.push(Math.floor(Math.random() * 50) + 10);
      }
      
      new Chart(ctx, {
        type: 'line',
        data: {
          labels: labels,
          datasets: [{
            label: 'New Users',
            data: data,
            borderColor: '#4facfe',
            backgroundColor: 'rgba(79, 172, 254, 0.1)',
            borderWidth: 2,
            fill: true,
            tension: 0.4
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: true,
          plugins: {
            legend: {
              labels: {
                color: '#ffffff'
              }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                color: '#b8c5d6'
              },
              grid: {
                color: 'rgba(255, 255, 255, 0.1)'
              }
            },
            x: {
              ticks: {
                color: '#b8c5d6'
              },
              grid: {
                color: 'rgba(255, 255, 255, 0.1)'
              }
            }
          }
        }
      });
    }
    
    function renderRevenueChart(deposits, withdrawals, investments, claims) {
      const ctx = document.getElementById('revenueChart');
      if (!ctx) return;
      
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: ['Deposits', 'Withdrawals', 'Investments', 'Claims'],
          datasets: [{
            label: 'Amount ($)',
            data: [deposits, withdrawals, investments, claims],
            backgroundColor: [
              'rgba(79, 172, 254, 0.8)',
              'rgba(255, 68, 68, 0.8)',
              'rgba(102, 126, 234, 0.8)',
              'rgba(0, 255, 136, 0.8)'
            ],
            borderColor: [
              '#4facfe',
              '#ff4444',
              '#667eea',
              '#00ff88'
            ],
            borderWidth: 2,
            borderRadius: 8
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: true,
          plugins: {
            legend: {
              display: false
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                color: '#b8c5d6',
                callback: function(value) {
                  return '$' + value;
                }
              },
              grid: {
                color: 'rgba(255, 255, 255, 0.1)'
              }
            },
            x: {
              ticks: {
                color: '#b8c5d6'
              },
              grid: {
                display: false
              }
            }
          }
        }
      });
    }
    
    // Deposits Management
    function renderDeposits() {
      const depositKeys = Object.keys(pendingDeposits);
      
      let html = `
        <div class="section-title">Deposit Management</div>
        
        <div class="filter-group">
          <button class="filter-btn active" onclick="filterDeposits('all')">All</button>
          <button class="filter-btn" onclick="filterDeposits('pending')">Pending</button>
          <button class="filter-btn" onclick="filterDeposits('approved')">Approved</button>
          <button class="filter-btn" onclick="filterDeposits('rejected')">Rejected</button>
        </div>
        
        <div class="table-container">
          <table class="admin-table">
            <thead>
              <tr>
                <th>User</th>
                <th>Amount</th>
                <th>Tx Hash</th>
                <th>Time</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="depositsTableBody">
      `;
      
      if (depositKeys.length === 0) {
        html += `
          <tr>
            <td colspan="6">
              <div class="empty-state">
                <div class="empty-icon">💵</div>
                <div class="empty-text">No deposits found</div>
              </div>
            </td>
          </tr>
        `;
      } else {
        depositKeys.forEach(depositId => {
          const deposit = pendingDeposits[depositId];
          
          html += `
            <tr>
              <td>
                <div style="display: flex; align-items: center; gap: 8px;">
                  <img src="${deposit.userName ? allUsers[deposit.userId]?.avatar || '' : ''}" class="user-avatar" />
                  <div>
                    <div style="font-weight: 600; color: #fff;">${deposit.userName}</div>
                    <div style="font-size: 11px;">ID: ${deposit.userId}</div>
                  </div>
                </div>
              </td>
              <td style="font-weight: 700; color: #00f2fe;">$${deposit.amount.toFixed(2)}</td>
              <td style="font-size: 11px; max-width: 150px; overflow: hidden; text-overflow: ellipsis;">${deposit.txHash}</td>
              <td>${formatDate(deposit.timestamp)}</td>
              <td><span class="status-badge status-${deposit.status}">${deposit.status}</span></td>
              <td>
                ${deposit.status === 'pending' ? `
                  <button class="action-btn btn-approve" onclick="approveDeposit('${depositId}')">Approve</button>
                  <button class="action-btn btn-reject" onclick="rejectDeposit('${depositId}')">Reject</button>
                ` : ''}
                <button class="action-btn btn-view" onclick="viewDepositDetails('${depositId}')">View</button>
              </td>
            </tr>
          `;
        });
      }
      
      html += `
            </tbody>
          </table>
        </div>
      `;
      
      document.getElementById('adminContent').innerHTML = html;
    }
    
    function approveDeposit(depositId) {
      const deposit = pendingDeposits[depositId];
      if (!deposit) return;
      
      // Update user balance
      const userRef = db.ref('users/' + deposit.userId);
      userRef.once('value').then(snap => {
        if (snap.exists()) {
          const userData = snap.val();
          const newBalance = (userData.balance || 0) + deposit.amount;
          
          // Update user balance
          userRef.update({
            balance: newBalance
          });
          
          // Update transaction status
          db.ref(`users/${deposit.userId}/transactions/${depositId}`).update({
            status: 'approved'
          });
          
          // Update pending deposit status
          db.ref(`admin/pendingDeposits/${depositId}`).update({
            status: 'approved',
            approvedAt: now()
          });
          
          // Send notification to user
          sendTelegramNotification(deposit.userId, `✅ Deposit Approved!\nAmount: $${deposit.amount.toFixed(2)}\nYour new balance: $${newBalance.toFixed(2)}`);
          
          notify('Deposit approved successfully!', 'success');
          renderDeposits();
        }
      });
    }
    
    function rejectDeposit(depositId) {
      const deposit = pendingDeposits[depositId];
      if (!deposit) return;
      
      // Update transaction status
      db.ref(`users/${deposit.userId}/transactions/${depositId}`).update({
        status: 'rejected'
      });
      
      // Update pending deposit status
      db.ref(`admin/pendingDeposits/${depositId}`).update({
        status: 'rejected',
        rejectedAt: now()
      });
      
      // Send notification to user
      sendTelegramNotification(deposit.userId, `❌ Deposit Rejected\nAmount: $${deposit.amount.toFixed(2)}\nPlease contact support for more information.`);
      
      notify('Deposit rejected!', 'error');
      renderDeposits();
    }
    
    function viewDepositDetails(depositId) {
      const deposit = pendingDeposits[depositId];
      if (!deposit) return;
      
      const html = `
        <div class="detail-row">
          <span class="detail-label">User Name:</span>
          <span class="detail-value">${deposit.userName}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">User ID:</span>
          <span class="detail-value">${deposit.userId}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Amount:</span>
          <span class="detail-value">$${deposit.amount.toFixed(2)}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Address:</span>
          <span class="detail-value" style="word-break: break-all;">${deposit.address}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Memo:</span>
          <span class="detail-value">${deposit.memo}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Tx Hash:</span>
          <span class="detail-value" style="word-break: break-all;">${deposit.txHash}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Time:</span>
          <span class="detail-value">${formatDate(deposit.timestamp)}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Status:</span>
          <span class="detail-value"><span class="status-badge status-${deposit.status}">${deposit.status}</span></span>
        </div>
      `;
      
      document.getElementById('modalTitle').textContent = 'Deposit Details';
      document.getElementById('modalContent').innerHTML = html;
      document.getElementById('detailModal').style.display = 'flex';
    }
    
    // Withdrawals Management
    function renderWithdrawals() {
      const withdrawalKeys = Object.keys(pendingWithdrawals);
      
      let html = `
        <div class="section-title">Withdrawal Management</div>
        
        <div class="filter-group">
          <button class="filter-btn active" onclick="filterWithdrawals('all')">All</button>
          <button class="filter-btn" onclick="filterWithdrawals('pending')">Pending</button>
          <button class="filter-btn" onclick="filterWithdrawals('approved')">Approved</button>
          <button class="filter-btn" onclick="filterWithdrawals('rejected')">Rejected</button>
        </div>
        
        <div class="table-container">
          <table class="admin-table">
            <thead>
              <tr>
                <th>User</th>
                <th>Amount</th>
                <th>Address</th>
                <th>Time</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="withdrawalsTableBody">
      `;
      
      if (withdrawalKeys.length === 0) {
        html += `
          <tr>
            <td colspan="6">
              <div class="empty-state">
                <div class="empty-icon">💸</div>
                <div class="empty-text">No withdrawals found</div>
              </div>
            </td>
          </tr>
        `;
      } else {
        withdrawalKeys.forEach(withdrawalId => {
          const withdrawal = pendingWithdrawals[withdrawalId];
          
          html += `
            <tr>
              <td>
                <div style="display: flex; align-items: center; gap: 8px;">
                  <img src="${withdrawal.userName ? allUsers[withdrawal.userId]?.avatar || '' : ''}" class="user-avatar" />
                  <div>
                    <div style="font-weight: 600; color: #fff;">${withdrawal.userName}</div>
                    <div style="font-size: 11px;">ID: ${withdrawal.userId}</div>
                  </div>
                </div>
              </td>
              <td style="font-weight: 700; color: #ff4444;">$${withdrawal.amount.toFixed(2)}</td>
              <td style="font-size: 11px; max-width: 150px; overflow: hidden; text-overflow: ellipsis;">${withdrawal.address}</td>
              <td>${formatDate(withdrawal.timestamp)}</td>
              <td><span class="status-badge status-${withdrawal.status}">${withdrawal.status}</span></td>
              <td>
                ${withdrawal.status === 'pending' ? `
                  <button class="action-btn btn-approve" onclick="approveWithdrawal('${withdrawalId}')">Approve</button>
                  <button class="action-btn btn-reject" onclick="rejectWithdrawal('${withdrawalId}')">Reject</button>
                ` : ''}
                <button class="action-btn btn-view" onclick="viewWithdrawalDetails('${withdrawalId}')">View</button>
              </td>
            </tr>
          `;
        });
      }
      
      html += `
            </tbody>
          </table>
        </div>
      `;
      
      document.getElementById('adminContent').innerHTML = html;
    }
    
    function approveWithdrawal(withdrawalId) {
      const withdrawal = pendingWithdrawals[withdrawalId];
      if (!withdrawal) return;
      
      // Update user balance
      const userRef = db.ref('users/' + withdrawal.userId);
      userRef.once('value').then(snap => {
        if (snap.exists()) {
          const userData = snap.val();
          const newBalance = (userData.balance || 0) - withdrawal.amount;
          
          if (newBalance < 0) {
            notify('Insufficient user balance!', 'error');
            return;
          }
          
          // Update user balance
          userRef.update({
            balance: newBalance
          });
          
          // Update transaction status
          db.ref(`users/${withdrawal.userId}/transactions/${withdrawalId}`).update({
            status: 'approved'
          });
          
          // Update pending withdrawal status
          db.ref(`admin/pendingWithdrawals/${withdrawalId}`).update({
            status: 'approved',
            approvedAt: now()
          });
          
          // Send notification to user
          sendTelegramNotification(withdrawal.userId, `✅ Withdrawal Approved!\nAmount: $${withdrawal.amount.toFixed(2)}\nAddress: ${withdrawal.address}\nFunds will be sent shortly.`);
          
          notify('Withdrawal approved successfully!', 'success');
          renderWithdrawals();
        }
      });
    }
    
    function rejectWithdrawal(withdrawalId) {
      const withdrawal = pendingWithdrawals[withdrawalId];
      if (!withdrawal) return;
      
      // Update transaction status
      db.ref(`users/${withdrawal.userId}/transactions/${withdrawalId}`).update({
        status: 'rejected'
      });
      
      // Update pending withdrawal status
      db.ref(`admin/pendingWithdrawals/${withdrawalId}`).update({
        status: 'rejected',
        rejectedAt: now()
      });
      
      // Send notification to user
      sendTelegramNotification(withdrawal.userId, `❌ Withdrawal Rejected\nAmount: $${withdrawal.amount.toFixed(2)}\nPlease contact support for more information.`);
      
      notify('Withdrawal rejected!', 'error');
      renderWithdrawals();
    }
    
    function viewWithdrawalDetails(withdrawalId) {
      const withdrawal = pendingWithdrawals[withdrawalId];
      if (!withdrawal) return;
      
      const html = `
        <div class="detail-row">
          <span class="detail-label">User Name:</span>
          <span class="detail-value">${withdrawal.userName}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">User ID:</span>
          <span class="detail-value">${withdrawal.userId}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Current Balance:</span>
          <span class="detail-value">$${withdrawal.currentBalance.toFixed(2)}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Withdrawal Amount:</span>
          <span class="detail-value">$${withdrawal.amount.toFixed(2)}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Address:</span>
          <span class="detail-value" style="word-break: break-all;">${withdrawal.address}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Memo:</span>
          <span class="detail-value">${withdrawal.memo || 'N/A'}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Time:</span>
          <span class="detail-value">${formatDate(withdrawal.timestamp)}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Status:</span>
          <span class="detail-value"><span class="status-badge status-${withdrawal.status}">${withdrawal.status}</span></span>
        </div>
      `;
      
      document.getElementById('modalTitle').textContent = 'Withdrawal Details';
      document.getElementById('modalContent').innerHTML = html;
      document.getElementById('detailModal').style.display = 'flex';
    }
    
    // Users Management
    function renderUsers() {
      const userKeys = Object.keys(allUsers);
      
      let html = `
        <div class="section-title">User Management</div>
        
        <div class="search-box">
          <input type="text" class="search-input" placeholder="Search by name or ID..." onkeyup="searchUsers(this.value)" />
        </div>
        
        <div class="table-container">
          <table class="admin-table">
            <thead>
              <tr>
                <th>User</th>
                <th>Balance</th>
                <th>Active Trades</th>
                <th>Referrals</th>
                <th>Joined</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="usersTableBody">
      `;
      
      if (userKeys.length === 0) {
        html += `
          <tr>
            <td colspan="6">
              <div class="empty-state">
                <div class="empty-icon">👥</div>
                <div class="empty-text">No users found</div>
              </div>
            </td>
          </tr>
        `;
      } else {
        userKeys.forEach(userId => {
          const user = allUsers[userId];
          const activeTrades = user.trades ? Object.keys(user.trades).length : 0;
          const referrals = user.totalReferrals || 0;
          
          html += `
            <tr>
              <td>
                <div style="display: flex; align-items: center; gap: 8px;">
                  <img src="${user.avatar}" class="user-avatar" />
                  <div>
                    <div style="font-weight: 600; color: #fff;">${user.name}</div>
                    <div style="font-size: 11px;">ID: ${userId}</div>
                  </div>
                </div>
              </td>
              <td style="font-weight: 700; color: #00f2fe;">$${(user.balance || 0).toFixed(2)}</td>
              <td>${activeTrades}</td>
              <td>${referrals}</td>
              <td>${formatDate(user.createdAt || now())}</td>
              <td>
                <button class="action-btn btn-view" onclick="viewUserDetails('${userId}')">View</button>
                <button class="action-btn btn-approve" onclick="editUserBalance('${userId}')">Edit Balance</button>
              </td>
            </tr>
          `;
        });
      }
      
      html += `
            </tbody>
          </table>
        </div>
      `;
      
      document.getElementById('adminContent').innerHTML = html;
    }
    
    function viewUserDetails(userId) {
      const user = allUsers[userId];
      if (!user) return;
      
      const activeTrades = user.trades ? Object.keys(user.trades).length : 0;
      const totalInvestment = user.trades ? Object.values(user.trades).reduce((sum, trade) => sum + trade.investment, 0) : 0;
      const totalClaimed = user.trades ? Object.values(user.trades).reduce((sum, trade) => sum + trade.totalClaimed, 0) : 0;
      
      const html = `
        <div class="detail-row">
          <span class="detail-label">Name:</span>
          <span class="detail-value">${user.name}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">User ID:</span>
          <span class="detail-value">${userId}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Balance:</span>
          <span class="detail-value">$${(user.balance || 0).toFixed(2)}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Active Trades:</span>
          <span class="detail-value">${activeTrades}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Total Investment:</span>
          <span class="detail-value">$${totalInvestment.toFixed(2)}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Total Claimed:</span>
          <span class="detail-value">$${totalClaimed.toFixed(2)}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Total Referrals:</span>
          <span class="detail-value">${user.totalReferrals || 0}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Referral Earnings:</span>
          <span class="detail-value">$${(user.totalReferralEarnings || 0).toFixed(2)}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Referred By:</span>
          <span class="detail-value">${user.referredBy || 'Direct'}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Joined:</span>
          <span class="detail-value">${formatDate(user.createdAt || now())}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Last Seen:</span>
          <span class="detail-value">${formatDate(user.lastSeen || now())}</span>
        </div>
      `;
      
      document.getElementById('modalTitle').textContent = 'User Details';
      document.getElementById('modalContent').innerHTML = html;
      document.getElementById('detailModal').style.display = 'flex';
    }
    
    function editUserBalance(userId) {
      const user = allUsers[userId];
      if (!user) return;
      
      const newBalance = prompt(`Edit balance for ${user.name}\nCurrent balance: $${(user.balance || 0).toFixed(2)}\n\nEnter new balance:`);
      
      if (newBalance !== null && !isNaN(newBalance)) {
        const balance = parseFloat(newBalance);
        
        db.ref('users/' + userId).update({
          balance: balance
        });
        
        sendTelegramNotification(userId, `💰 Balance Updated\nYour new balance: $${balance.toFixed(2)}`);
        
        notify('User balance updated successfully!', 'success');
        renderUsers();
      }
    }
    
    function searchUsers(query) {
      const tbody = document.getElementById('usersTableBody');
      const rows = tbody.getElementsByTagName('tr');
      
      for (let i = 0; i < rows.length; i++) {
        const row = rows[i];
        const text = row.textContent.toLowerCase();
        
        if (text.includes(query.toLowerCase())) {
          row.style.display = '';
        } else {
          row.style.display = 'none';
        }
      }
    }
    
    // Trades Management
    function renderTrades() {
      const userKeys = Object.keys(allUsers);
      let allTrades = [];
      
      userKeys.forEach(userId => {
        const user = allUsers[userId];
        if (user.trades) {
          Object.keys(user.trades).forEach(pair => {
            const trade = user.trades[pair];
            allTrades.push({
              userId: userId,
              userName: user.name,
              userAvatar: user.avatar,
              pair: pair,
              ...trade
            });
          });
        }
      });
      
      let html = `
        <div class="section-title">Trade Management</div>
        
        <div class="table-container">
          <table class="admin-table">
            <thead>
              <tr>
                <th>User</th>
                <th>Pair</th>
                <th>Investment</th>
                <th>Daily Earning</th>
                <th>Total Claimed</th>
                <th>Duration</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
      `;
      
      if (allTrades.length === 0) {
        html += `
          <tr>
            <td colspan="8">
              <div class="empty-state">
                <div class="empty-icon">📈</div>
                <div class="empty-text">No active trades found</div>
              </div>
            </td>
          </tr>
        `;
      } else {
        allTrades.forEach(trade => {
          const elapsedDays = Math.floor((now() - trade.startTime) / 86400);
          const remainingDays = trade.duration - elapsedDays;
          
          html += `
            <tr>
              <td>
                <div style="display: flex; align-items: center; gap: 8px;">
                  <img src="${trade.userAvatar}" class="user-avatar" />
                  <div>
                    <div style="font-weight: 600; color: #fff;">${trade.userName}</div>
                    <div style="font-size: 11px;">ID: ${trade.userId}</div>
                  </div>
                </div>
              </td>
              <td style="font-weight: 700; color: #00f2fe;">${trade.pair}</td>
              <td>$${trade.investment.toFixed(2)}</td>
              <td style="color: #00ff88;">$${trade.dailyEarning.toFixed(2)}</td>
              <td>$${trade.totalClaimed.toFixed(2)}</td>
              <td>${remainingDays} days left</td>
              <td><span class="status-badge status-approved">${trade.status}</span></td>
              <td>
                <button class="action-btn btn-view" onclick="viewTradeDetails('${trade.userId}', '${trade.pair}')">View</button>
              </td>
            </tr>
          `;
        });
      }
      
      html += `
            </tbody>
          </table>
        </div>
      `;
      
      document.getElementById('adminContent').innerHTML = html;
    }
    
    function viewTradeDetails(userId, pair) {
      const user = allUsers[userId];
      if (!user || !user.trades || !user.trades[pair]) return;
      
      const trade = user.trades[pair];
      const elapsedDays = Math.floor((now() - trade.startTime) / 86400);
      const remainingDays = trade.duration - elapsedDays;
      const timeSinceLastClaim = now() - trade.lastClaimTime;
      const canClaim = timeSinceLastClaim >= 86400;
      
      const html = `
        <div class="detail-row">
          <span class="detail-label">User:</span>
          <span class="detail-value">${user.name}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Trading Pair:</span>
          <span class="detail-value">${trade.pair}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Investment:</span>
          <span class="detail-value">$${trade.investment.toFixed(2)}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Daily Earning:</span>
          <span class="detail-value">$${trade.dailyEarning.toFixed(2)}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Total Claimed:</span>
          <span class="detail-value">$${trade.totalClaimed.toFixed(2)}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Duration:</span>
          <span class="detail-value">${trade.duration} days</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Elapsed Days:</span>
          <span class="detail-value">${elapsedDays} days</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Remaining Days:</span>
          <span class="detail-value">${remainingDays} days</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Start Time:</span>
          <span class="detail-value">${formatDate(trade.startTime)}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Last Claim:</span>
          <span class="detail-value">${formatDate(trade.lastClaimTime)}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Can Claim:</span>
          <span class="detail-value">${canClaim ? 'Yes' : 'No'}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Status:</span>
          <span class="detail-value"><span class="status-badge status-approved">${trade.status}</span></span>
        </div>
      `;
      
      document.getElementById('modalTitle').textContent = 'Trade Details';
      document.getElementById('modalContent').innerHTML = html;
      document.getElementById('detailModal').style.display = 'flex';
    }
    
    // Redemption Codes Management
    function renderRedemption() {
      const codeKeys = Object.keys(redemptionCodes);
      
      let html = `
        <div class="section-title">Redemption Code Management</div>
        
        <div style="margin-bottom: 30px;">
          <form onsubmit="generateRedemptionCode(event)" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; align-items: end;">
            <div class="form-group" style="margin-bottom: 0;">
              <label class="form-label">Reward Amount ($)</label>
              <input type="number" class="form-input" id="rewardAmount" placeholder="0.10 - 1.00" min="0.10" max="1.00" step="0.01" required />
            </div>
            
            <div class="form-group" style="margin-bottom: 0;">
              <label class="form-label">Number of Codes</label>
              <input type="number" class="form-input" id="codeCount" placeholder="1-100" min="1" max="100" value="1" required />
            </div>
            
            <button type="submit" class="btn-primary">Generate Codes</button>
          </form>
        </div>
        
        <div class="table-container">
          <table class="admin-table">
            <thead>
              <tr>
                <th>Code</th>
                <th>Reward</th>
                <th>Status</th>
                <th>Used By</th>
                <th>Used At</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
      `;
      
      if (codeKeys.length === 0) {
        html += `
          <tr>
            <td colspan="6">
              <div class="empty-state">
                <div class="empty-icon">🎁</div>
                <div class="empty-text">No redemption codes generated yet</div>
              </div>
            </td>
          </tr>
        `;
      } else {
        codeKeys.forEach(code => {
          const codeData = redemptionCodes[code];
          
          html += `
            <tr>
              <td style="font-family: 'Courier New', monospace; font-weight: 700; color: #00f2fe;">${code}</td>
              <td>$${codeData.reward.toFixed(2)}</td>
              <td><span class="status-badge ${codeData.used ? 'status-approved' : 'status-pending'}">${codeData.used ? 'Used' : 'Active'}</span></td>
              <td>${codeData.usedBy || 'N/A'}</td>
              <td>${codeData.usedAt ? formatDate(codeData.usedAt) : 'N/A'}</td>
              <td>
                ${!codeData.used ? `
                  <button class="action-btn btn-delete" onclick="deleteRedemptionCode('${code}')">Delete</button>
                ` : ''}
              </td>
            </tr>
          `;
        });
      }
      
      html += `
            </tbody>
          </table>
        </div>
      `;
      
      document.getElementById('adminContent').innerHTML = html;
    }
    
    function generateRedemptionCode(event) {
      event.preventDefault();
      
      const rewardAmount = parseFloat(document.getElementById('rewardAmount').value);
      const codeCount = parseInt(document.getElementById('codeCount').value);
      
      if (rewardAmount < 0.10 || rewardAmount > 1.00) {
        notify('Reward amount must be between $0.10 and $1.00!', 'error');
        return;
      }
      
      if (codeCount < 1 || codeCount > 100) {
        notify('Code count must be between 1 and 100!', 'error');
        return;
      }
      
      // Generate codes
      for (let i = 0; i < codeCount; i++) {
        const code = generateRandomCode(8);
        
        db.ref('redemptionCodes/' + code).set({
          reward: rewardAmount,
          used: false,
          createdAt: now()
        });
      }
      
      notify(`Generated ${codeCount} redemption code(s) successfully!`, 'success');
      
      document.getElementById('rewardAmount').value = '';
      document.getElementById('codeCount').value = '1';
      
      renderRedemption();
    }
    
    function generateRandomCode(length) {
      const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
      let code = '';
      for (let i = 0; i < length; i++) {
        code += chars.charAt(Math.floor(Math.random() * chars.length));
      }
      return code;
    }
    
    function deleteRedemptionCode(code) {
      if (confirm('Are you sure you want to delete this redemption code?')) {
        db.ref('redemptionCodes/' + code).remove();
        notify('Redemption code deleted!', 'success');
        renderRedemption();
      }
    }
    
    // Analytics
    function renderAnalytics() {
      const html = `
        <div class="section-title">Platform Analytics</div>
        
        <div class="chart-container">
          <div class="chart-title">User Activity (Last 7 Days)</div>
          <canvas id="activityChart" width="400" height="200"></canvas>
        </div>
        
        <div class="chart-container">
          <div class="chart-title">Transaction Volume</div>
          <canvas id="transactionChart" width="400" height="200"></canvas>
        </div>
        
        <div class="chart-container">
          <div class="chart-title">Top Trading Pairs</div>
          <canvas id="tradingPairsChart" width="400" height="200"></canvas>
        </div>
      `;
      
      document.getElementById('adminContent').innerHTML = html;
      
      setTimeout(() => {
        renderActivityChart();
        renderTransactionChart();
        renderTradingPairsChart();
      }, 100);
    }
    
    function renderActivityChart() {
      const ctx = document.getElementById('activityChart');
      if (!ctx) return;
      
      const labels = [];
      const data = [];
      const today = new Date();
      
      for (let i = 6; i >= 0; i--) {
        const date = new Date(today);
        date.setDate(date.getDate() - i);
        labels.push(date.toLocaleDateString('en-US', { weekday: 'short' }));
        data.push(Math.floor(Math.random() * 100) + 20);
      }
      
      new Chart(ctx, {
        type: 'line',
        data: {
          labels: labels,
          datasets: [{
            label: 'Active Users',
            data: data,
            borderColor: '#4facfe',
            backgroundColor: 'rgba(79, 172, 254, 0.1)',
            borderWidth: 3,
            fill: true,
            tension: 0.4
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: {
              labels: {
                color: '#ffffff'
              }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                color: '#b8c5d6'
              },
              grid: {
                color: 'rgba(255, 255, 255, 0.1)'
              }
            },
            x: {
              ticks: {
                color: '#b8c5d6'
              },
              grid: {
                color: 'rgba(255, 255, 255, 0.1)'
              }
            }
          }
        }
      });
    }
    
    function renderTransactionChart() {
      const ctx = document.getElementById('transactionChart');
      if (!ctx) return;
      
      new Chart(ctx, {
        type: 'doughnut',
        data: {
          labels: ['Deposits', 'Withdrawals', 'Trade Purchases', 'Trade Claims'],
          datasets: [{
            data: [45, 20, 25, 10],
            backgroundColor: [
              'rgba(79, 172, 254, 0.8)',
              'rgba(255, 68, 68, 0.8)',
              'rgba(102, 126, 234, 0.8)',
              'rgba(0, 255, 136, 0.8)'
            ],
            borderColor: [
              '#4facfe',
              '#ff4444',
              '#667eea',
              '#00ff88'
            ],
            borderWidth: 2
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: {
              position: 'bottom',
              labels: {
                color: '#ffffff',
                padding: 20
              }
            }
          }
        }
      });
    }
    
    function renderTradingPairsChart() {
      const ctx = document.getElementById('tradingPairsChart');
      if (!ctx) return;
      
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: ['BTC/USDT', 'ETH/USDT', 'BNB/USDT', 'SOL/USDT', 'XRP/USDT'],
          datasets: [{
            label: 'Active Trades',
            data: [45, 38, 32, 28, 25],
            backgroundColor: 'rgba(79, 172, 254, 0.8)',
            borderColor: '#4facfe',
            borderWidth: 2,
            borderRadius: 8
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: {
              display: false
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                color: '#b8c5d6'
              },
              grid: {
                color: 'rgba(255, 255, 255, 0.1)'
              }
            },
            x: {
              ticks: {
                color: '#b8c5d6'
              },
              grid: {
                display: false
              }
            }
          }
        }
      });
    }
    
    // Settings
    function renderSettings() {
      const html = `
        <div class="section-title">Platform Settings</div>
        
        <div style="display: grid; gap: 30px;">
          <div style="background: rgba(255, 255, 255, 0.05); border-radius: 16px; padding: 24px; border: 1px solid var(--card-border);">
            <h3 style="font-size: 18px; font-weight: 700; color: #fff; margin-bottom: 20px;">Deposit Settings</h3>
            
            <div class="form-group">
              <label class="form-label">Minimum Deposit Amount ($)</label>
              <input type="number" class="form-input" value="30" min="1" step="0.01" />
            </div>
            
            <div class="form-group">
              <label class="form-label">Deposit Wallet Address</label>
              <input type="text" class="form-input" value="UQBWOgFgB4B8qBCo8CNjDUNAtvUSosw4v7v9gkt0GVOaNLSz" />
            </div>
            
            <button class="btn-primary">Save Changes</button>
          </div>
          
          <div style="background: rgba(255, 255, 255, 0.05); border-radius: 16px; padding: 24px; border: 1px solid var(--card-border);">
            <h3 style="font-size: 18px; font-weight: 700; color: #fff; margin-bottom: 20px;">Withdrawal Settings</h3>
            
            <div class="form-group">
              <label class="form-label">Minimum Withdrawal Amount ($)</label>
              <input type="number" class="form-input" value="0.10" min="0.01" step="0.01" />
            </div>
            
            <div class="form-group">
              <label class="form-label">Withdrawal Fee (%)</label>
              <input type="number" class="form-input" value="0" min="0" max="100" step="0.1" />
            </div>
            
            <button class="btn-primary">Save Changes</button>
          </div>
          
          <div style="background: rgba(255, 255, 255, 0.05); border-radius: 16px; padding: 24px; border: 1px solid var(--card-border);">
            <h3 style="font-size: 18px; font-weight: 700; color: #fff; margin-bottom: 20px;">Referral Settings</h3>
            
            <div class="form-group">
              <label class="form-label">Signup Bonus ($)</label>
              <input type="number" class="form-input" value="0.20" min="0" step="0.01" />
            </div>
            
            <div class="form-group">
              <label class="form-label">Commission Rate (%)</label>
              <input type="number" class="form-input" value="20" min="0" max="100" step="1" />
            </div>
            
            <button class="btn-primary">Save Changes</button>
          </div>
          
          <div style="background: rgba(255, 255, 255, 0.05); border-radius: 16px; padding: 24px; border: 1px solid var(--card-border);">
            <h3 style="font-size: 18px; font-weight: 700; color: #fff; margin-bottom: 20px;">Telegram Bot Settings</h3>
            
            <div class="form-group">
              <label class="form-label">Bot Token</label>
              <input type="text" class="form-input" value="${BOT_TOKEN}" readonly />
            </div>
            
            <div class="form-group">
              <label class="form-label">Bot Username</label>
              <input type="text" class="form-input" value="@SharkBountybot" readonly />
            </div>
          </div>
          
          <div style="background: rgba(255, 68, 68, 0.1); border-radius: 16px; padding: 24px; border: 2px solid var(--accent-red);">
            <h3 style="font-size: 18px; font-weight: 700; color: var(--accent-red); margin-bottom: 20px;">Danger Zone</h3>
            
            <p style="color: var(--text-secondary); margin-bottom: 20px;">
              These actions are irreversible. Please be careful.
            </p>
            
            <button class="action-btn btn-delete" onclick="clearAllData()">Clear All Data</button>
            <button class="action-btn btn-delete" onclick="resetPlatform()">Reset Platform</button>
          </div>
        </div>
      `;
      
      document.getElementById('adminContent').innerHTML = html;
    }
    
    function clearAllData() {
      if (confirm('Are you sure you want to clear all data? This action cannot be undone!')) {
        if (confirm('This will delete ALL users, trades, transactions, and codes. Are you absolutely sure?')) {
          db.ref('users').remove();
          db.ref('admin').remove();
          db.ref('redemptionCodes').remove();
          
          notify('All data cleared!', 'success');
          setTimeout(() => {
            location.reload();
          }, 2000);
        }
      }
    }
    
    function resetPlatform() {
      if (confirm('Are you sure you want to reset the platform? This will clear all data and reset settings!')) {
        clearAllData();
      }
    }
    
    // Modal Functions
    function closeModal(modalId) {
      document.getElementById(modalId).style.display = 'none';
    }
    
    // Filter Functions
    function filterDeposits(status) {
      // Update active filter button
      document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      event.target.classList.add('active');
      
      // Filter table rows
      const tbody = document.getElementById('depositsTableBody');
      const rows = tbody.getElementsByTagName('tr');
      
      for (let i = 0; i < rows.length; i++) {
        const row = rows[i];
        const statusBadge = row.querySelector('.status-badge');
        
        if (!statusBadge) continue;
        
        if (status === 'all') {
          row.style.display = '';
        } else {
          const rowStatus = statusBadge.textContent.toLowerCase();
          row.style.display = rowStatus === status ? '' : 'none';
        }
      }
    }
    
    function filterWithdrawals(status) {
      // Update active filter button
      document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      event.target.classList.add('active');
      
      // Filter table rows
      const tbody = document.getElementById('withdrawalsTableBody');
      const rows = tbody.getElementsByTagName('tr');
      
      for (let i = 0; i < rows.length; i++) {
        const row = rows[i];
        const statusBadge = row.querySelector('.status-badge');
        
        if (!statusBadge) continue;
        
        if (status === 'all') {
          row.style.display = '';
        } else {
          const rowStatus = statusBadge.textContent.toLowerCase();
          row.style.display = rowStatus === status ? '' : 'none';
        }
      }
    }
    
    // Initialize Admin Panel
    function initializeAdmin() {
      loadAllData();
      renderDashboard();
    }
    
    // Start the admin panel
    initializeAdmin();
  </script>
</body>
</html>
