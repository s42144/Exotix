<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exotix - Admin Panel</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary-color: #6c5ce7;
            --secondary-color: #a29bfe;
            --success-color: #00b894;
            --danger-color: #d63031;
            --warning-color: #fdcb6e;
            --dark-bg: #0a0e27;
            --card-bg: #1a1f3a;
            --text-primary: #ffffff;
            --text-secondary: #b2bec3;
        }

        body {
            background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 100%);
            color: var(--text-primary);
            min-height: 100vh;
        }

        /* Header */
        .header {
            background: rgba(26, 31, 58, 0.95);
            backdrop-filter: blur(10px);
            padding: 20px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .logo {
            font-size: 32px;
            font-weight: bold;
            background: linear-gradient(45deg, #6c5ce7, #a29bfe);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .admin-badge {
            background: linear-gradient(45deg, var(--danger-color), #ff7675);
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: bold;
        }

        /* Sidebar */
        .container {
            display: flex;
            min-height: calc(100vh - 80px);
        }

        .sidebar {
            width: 280px;
            background: rgba(26, 31, 58, 0.8);
            padding: 30px 20px;
            border-right: 2px solid rgba(108, 92, 231, 0.2);
        }

        .menu-item {
            padding: 15px 20px;
            margin-bottom: 10px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 15px;
            color: var(--text-secondary);
        }

        .menu-item:hover {
            background: rgba(108, 92, 231, 0.2);
            color: var(--text-primary);
        }

        .menu-item.active {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: white;
        }

        .menu-icon {
            font-size: 24px;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            padding: 40px;
            overflow-y: auto;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-title {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 30px;
            background: linear-gradient(45deg, #6c5ce7, #a29bfe);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: rgba(26, 31, 58, 0.8);
            padding: 30px;
            border-radius: 15px;
            border: 2px solid rgba(108, 92, 231, 0.3);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(108, 92, 231, 0.3);
        }

        .stat-icon {
            font-size: 40px;
            margin-bottom: 15px;
        }

        .stat-value {
            font-size: 36px;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 14px;
            color: var(--text-secondary);
        }

        /* Tables */
        .table-container {
            background: rgba(26, 31, 58, 0.8);
            border-radius: 15px;
            padding: 20px;
            overflow-x: auto;
            margin-bottom: 30px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th,
        .data-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid rgba(108, 92, 231, 0.2);
        }

        .data-table th {
            background: rgba(108, 92, 231, 0.2);
            font-weight: bold;
            position: sticky;
            top: 0;
        }

        .data-table tr:hover {
            background: rgba(108, 92, 231, 0.1);
        }

        /* Buttons */
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            margin-right: 10px;
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .btn-success:hover {
            background: #00a383;
            transform: scale(1.05);
        }

        .btn-danger {
            background: var(--danger-color);
            color: white;
        }

        .btn-danger:hover {
            background: #c0282a;
            transform: scale(1.05);
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: #5f4dd1;
            transform: scale(1.05);
        }

        .btn-warning {
            background: var(--warning-color);
            color: #0a0e27;
        }

        /* Forms */
        .form-container {
            background: rgba(26, 31, 58, 0.8);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-secondary);
            font-size: 14px;
            font-weight: bold;
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 15px;
            background: rgba(10, 14, 39, 0.5);
            border: 2px solid rgba(108, 92, 231, 0.3);
            border-radius: 10px;
            color: white;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 10px rgba(108, 92, 231, 0.3);
        }

        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }

        /* Status Badges */
        .status-badge {
            padding: 5px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
            display: inline-block;
        }

        .status-pending {
            background: var(--warning-color);
            color: #0a0e27;
        }

        .status-approved {
            background: var(--success-color);
            color: white;
        }

        .status-rejected {
            background: var(--danger-color);
            color: white;
        }

        /* User Avatar */
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
        }

        /* Search Bar */
        .search-bar {
            width: 100%;
            padding: 15px;
            background: rgba(10, 14, 39, 0.5);
            border: 2px solid rgba(108, 92, 231, 0.3);
            border-radius: 10px;
            color: white;
            font-size: 16px;
            margin-bottom: 20px;
        }

        .search-bar:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--card-bg);
            padding: 40px;
            border-radius: 20px;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 20px;
            color: var(--primary-color);
        }

        .modal-close {
            float: right;
            font-size: 28px;
            cursor: pointer;
            color: var(--text-secondary);
        }

        .modal-close:hover {
            color: var(--danger-color);
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 100px;
            right: 20px;
            background: rgba(26, 31, 58, 0.98);
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid var(--primary-color);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            animation: slideIn 0.3s ease;
            max-width: 350px;
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .notification.success {
            border-left-color: var(--success-color);
        }

        .notification.error {
            border-left-color: var(--danger-color);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                border-right: none;
                border-bottom: 2px solid rgba(108, 92, 231, 0.2);
            }

            .main-content {
                padding: 20px;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }
        }

        .action-buttons {
            display: flex;
            gap: 10px;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
        }

        .empty-state-icon {
            font-size: 64px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .code-display {
            background: rgba(10, 14, 39, 0.5);
            padding: 20px;
            border-radius: 10px;
            font-size: 32px;
            font-weight: bold;
            text-align: center;
            color: var(--success-color);
            margin: 20px 0;
            letter-spacing: 5px;
        }

        .plan-preview {
            background: rgba(10, 14, 39, 0.5);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .plan-preview-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid rgba(108, 92, 231, 0.2);
        }

        .image-preview {
            max-width: 200px;
            max-height: 200px;
            border-radius: 10px;
            margin-top: 10px;
        }
    </style>
<script src="https://sites.super.myninja.ai/_assets/ninja-daytona-script.js"></script>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="logo">EXOTIX ADMIN</div>
        <div class="admin-badge">🔐 Admin Panel</div>
    </div>

    <!-- Main Container -->
    <div class="container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="menu-item active" onclick="showSection('dashboard')">
                <span class="menu-icon">📊</span>
                <span>Dashboard</span>
            </div>
            <div class="menu-item" onclick="showSection('users')">
                <span class="menu-icon">👥</span>
                <span>Users</span>
            </div>
            <div class="menu-item" onclick="showSection('deposits')">
                <span class="menu-icon">💰</span>
                <span>Deposits</span>
            </div>
            <div class="menu-item" onclick="showSection('withdrawals')">
                <span class="menu-icon">💸</span>
                <span>Withdrawals</span>
            </div>
            <div class="menu-item" onclick="showSection('plans')">
                <span class="menu-icon">📈</span>
                <span>Plans</span>
            </div>
            <div class="menu-item" onclick="showSection('tasks')">
                <span class="menu-icon">✅</span>
                <span>Tasks</span>
            </div>
            <div class="menu-item" onclick="showSection('redeem')">
                <span class="menu-icon">🎁</span>
                <span>Redeem Codes</span>
            </div>
            <div class="menu-item" onclick="showSection('branding')">
                <span class="menu-icon">🎨</span>
                <span>Branding</span>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Dashboard Section -->
            <div id="dashboard" class="section active">
                <h1 class="section-title">Dashboard</h1>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">👥</div>
                        <div class="stat-value" id="totalUsers">0</div>
                        <div class="stat-label">Total Users</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">📅</div>
                        <div class="stat-value" id="todayUsers">0</div>
                        <div class="stat-label">Today's Users</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">💰</div>
                        <div class="stat-value">$<span id="totalDeposits">0</span></div>
                        <div class="stat-label">Total Deposits</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">💸</div>
                        <div class="stat-value">$<span id="totalWithdrawals">0</span></div>
                        <div class="stat-label">Total Withdrawals</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">📊</div>
                        <div class="stat-value" id="activePlans">0</div>
                        <div class="stat-label">Active Plans</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">⏳</div>
                        <div class="stat-value" id="pendingDeposits">0</div>
                        <div class="stat-label">Pending Deposits</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">⏳</div>
                        <div class="stat-value" id="pendingWithdrawals">0</div>
                        <div class="stat-label">Pending Withdrawals</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">💎</div>
                        <div class="stat-value">$<span id="platformRevenue">0</span></div>
                        <div class="stat-label">Platform Revenue</div>
                    </div>
                </div>

                <h2 style="margin-bottom: 20px;">Recent Activities</h2>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>User</th>
                                <th>Action</th>
                                <th>Amount</th>
                                <th>Time</th>
                            </tr>
                        </thead>
                        <tbody id="recentActivities"></tbody>
                    </table>
                </div>
            </div>

            <!-- Users Section -->
            <div id="users" class="section">
                <h1 class="section-title">User Management</h1>
                <input type="text" class="search-bar" id="userSearch" placeholder="Search users by name or ID..." onkeyup="filterUsers()">
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Avatar</th>
                                <th>Name</th>
                                <th>User ID</th>
                                <th>Balance</th>
                                <th>Total Deposit</th>
                                <th>Referrals</th>
                                <th>Joined</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="usersTable"></tbody>
                    </table>
                </div>
            </div>

            <!-- Deposits Section -->
            <div id="deposits" class="section">
                <h1 class="section-title">Deposit Management</h1>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>User</th>
                                <th>Amount</th>
                                <th>TX Hash</th>
                                <th>Address</th>
                                <th>Memo</th>
                                <th>Status</th>
                                <th>Time</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="depositsTable"></tbody>
                    </table>
                </div>
            </div>

            <!-- Withdrawals Section -->
            <div id="withdrawals" class="section">
                <h1 class="section-title">Withdrawal Management</h1>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>User</th>
                                <th>Amount</th>
                                <th>Address</th>
                                <th>Memo</th>
                                <th>Status</th>
                                <th>Time</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="withdrawalsTable"></tbody>
                    </table>
                </div>
            </div>

            <!-- Plans Section -->
            <div id="plans" class="section">
                <h1 class="section-title">Plans Management</h1>
                <div class="form-container">
                    <h2 style="margin-bottom: 20px;">Edit Trading Plans</h2>
                    <p style="color: var(--text-secondary); margin-bottom: 20px;">
                        Note: Plans are currently hardcoded. You can view active user plans below.
                    </p>
                </div>
                <h2 style="margin-bottom: 20px;">Active User Plans</h2>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>User</th>
                                <th>Plan</th>
                                <th>Investment</th>
                                <th>Daily Earning</th>
                                <th>Claims Left</th>
                                <th>Total Earned</th>
                                <th>Purchased</th>
                            </tr>
                        </thead>
                        <tbody id="userPlansTable"></tbody>
                    </table>
                </div>
            </div>

            <!-- Tasks Section -->
            <div id="tasks" class="section">
                <h1 class="section-title">Tasks Management</h1>
                <div class="form-container">
                    <h2 style="margin-bottom: 20px;">Add New Task</h2>
                    <div class="form-group">
                        <label class="form-label">Task Logo URL</label>
                        <input type="text" class="form-input" id="taskLogo" placeholder="Enter logo URL">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Task Heading</label>
                        <input type="text" class="form-input" id="taskHeading" placeholder="Enter task heading">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Task Description</label>
                        <textarea class="form-textarea" id="taskDescription" placeholder="Enter task description"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Task Link</label>
                        <input type="text" class="form-input" id="taskLink" placeholder="Enter task link">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Reward (USDT)</label>
                        <input type="number" class="form-input" id="taskReward" placeholder="Enter reward amount" step="0.01">
                    </div>
                    <button class="btn btn-primary" onclick="addTask()">Add Task</button>
                </div>

                <h2 style="margin-bottom: 20px;">Active Tasks</h2>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Logo</th>
                                <th>Heading</th>
                                <th>Description</th>
                                <th>Reward</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="tasksTable"></tbody>
                    </table>
                </div>
            </div>

            <!-- Redeem Codes Section -->
            <div id="redeem" class="section">
                <h1 class="section-title">Redeem Code Generator</h1>
                <div class="form-container">
                    <h2 style="margin-bottom: 20px;">Generate New Code</h2>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Minimum Amount ($)</label>
                            <input type="number" class="form-input" id="redeemMin" placeholder="0.10" step="0.01" value="0.10">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Maximum Amount ($)</label>
                            <input type="number" class="form-input" id="redeemMax" placeholder="1.00" step="0.01" value="1.00">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Number of Uses (0 = unlimited)</label>
                        <input type="number" class="form-input" id="redeemUses" placeholder="0" value="1">
                    </div>
                    <button class="btn btn-primary" onclick="generateRedeemCode()">Generate Code</button>
                    <div id="generatedCode"></div>
                </div>

                <h2 style="margin-bottom: 20px;">Active Redeem Codes</h2>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Code</th>
                                <th>Amount Range</th>
                                <th>Uses</th>
                                <th>Status</th>
                                <th>Created</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="redeemCodesTable"></tbody>
                    </table>
                </div>
            </div>

            <!-- Branding Section -->
            <div id="branding" class="section">
                <h1 class="section-title">Branding & Customization</h1>
                <div class="form-container">
                    <h2 style="margin-bottom: 20px;">Platform Settings</h2>
                    <div class="form-group">
                        <label class="form-label">Platform Name</label>
                        <input type="text" class="form-input" id="platformName" value="EXOTIX">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Welcome Message</label>
                        <textarea class="form-textarea" id="welcomeMessage" placeholder="Enter welcome message for new users"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Support Link</label>
                        <input type="text" class="form-input" id="supportLink" placeholder="Enter support link">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Minimum Deposit ($)</label>
                        <input type="number" class="form-input" id="minDeposit" value="30" step="1">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Minimum Withdrawal ($)</label>
                        <input type="number" class="form-input" id="minWithdraw" value="0.10" step="0.01">
                    </div>
                    <button class="btn btn-primary" onclick="saveBranding()">Save Settings</button>
                </div>
            </div>
        </div>
    </div>

    <!-- User Edit Modal -->
    <div id="userModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeModal('userModal')">&times;</span>
            <div class="modal-header">Edit User</div>
            <div class="form-group">
                <label class="form-label">User ID</label>
                <input type="text" class="form-input" id="editUserId" readonly>
            </div>
            <div class="form-group">
                <label class="form-label">Balance ($)</label>
                <input type="number" class="form-input" id="editUserBalance" step="0.01">
            </div>
            <div class="form-group">
                <label class="form-label">Action</label>
                <select class="form-select" id="balanceAction">
                    <option value="set">Set Balance</option>
                    <option value="add">Add to Balance</option>
                    <option value="subtract">Subtract from Balance</option>
                </select>
            </div>
            <button class="btn btn-primary" onclick="updateUserBalance()">Update Balance</button>
            <button class="btn btn-danger" onclick="banUser()">Ban User</button>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getDatabase, ref, set, get, update, push, onValue, remove } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';

        const firebaseConfig = {
            apiKey: "AIzaSyBfR97veh6idxb81mH6N5_Gq8-CpW2D7bE",
            authDomain: "jbhigfi.firebaseapp.com",
            databaseURL: "https://jbhigfi-default-rtdb.firebaseio.com",
            projectId: "jbhigfi",
            storageBucket: "jbhigfi.firebasestorage.app",
            messagingSenderId: "736760492095",
            appId: "1:736760492095:web:47b94412495e21c561c88a",
            measurementId: "G-ZZMHC9RTVT"
        };

        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);
        window.database = database;
        window.dbRef = ref;
        window.dbSet = set;
        window.dbGet = get;
        window.dbUpdate = update;
        window.dbPush = push;
        window.dbOnValue = onValue;
        window.dbRemove = remove;
    </script>

    <script>
        const BOT_TOKEN = '8332448822:AAHKhDvougBhBThL6aBl3hGjZbKFGAq7BUs';

        // Initialize
        window.addEventListener('load', () => {
            loadDashboard();
            loadUsers();
            loadDeposits();
            loadWithdrawals();
            loadUserPlans();
            loadTasks();
            loadRedeemCodes();
        });

        // Dashboard
        async function loadDashboard() {
            try {
                // Load users
                const usersRef = window.dbRef(window.database, 'users');
                const usersSnapshot = await window.dbGet(usersRef);
                const users = usersSnapshot.exists() ? Object.values(usersSnapshot.val()) : [];
                
                document.getElementById('totalUsers').textContent = users.length;
                
                // Today's users
                const today = new Date().setHours(0, 0, 0, 0);
                const todayUsers = users.filter(u => u.createdAt >= today).length;
                document.getElementById('todayUsers').textContent = todayUsers;

                // Total deposits
                const depositsRef = window.dbRef(window.database, 'deposits');
                const depositsSnapshot = await window.dbGet(depositsRef);
                let totalDeposits = 0;
                let pendingDeposits = 0;
                if (depositsSnapshot.exists()) {
                    const deposits = Object.values(depositsSnapshot.val());
                    totalDeposits = deposits.filter(d => d.status === 'approved').reduce((sum, d) => sum + d.amount, 0);
                    pendingDeposits = deposits.filter(d => d.status === 'pending').length;
                }
                document.getElementById('totalDeposits').textContent = totalDeposits.toFixed(2);
                document.getElementById('pendingDeposits').textContent = pendingDeposits;

                // Total withdrawals
                const withdrawalsRef = window.dbRef(window.database, 'withdrawals');
                const withdrawalsSnapshot = await window.dbGet(withdrawalsRef);
                let totalWithdrawals = 0;
                let pendingWithdrawals = 0;
                if (withdrawalsSnapshot.exists()) {
                    const withdrawals = Object.values(withdrawalsSnapshot.val());
                    totalWithdrawals = withdrawals.filter(w => w.status === 'approved').reduce((sum, w) => sum + w.amount, 0);
                    pendingWithdrawals = withdrawals.filter(w => w.status === 'pending').length;
                }
                document.getElementById('totalWithdrawals').textContent = totalWithdrawals.toFixed(2);
                document.getElementById('pendingWithdrawals').textContent = pendingWithdrawals;

                // Active plans
                const plansRef = window.dbRef(window.database, 'userPlans');
                const plansSnapshot = await window.dbGet(plansRef);
                let activePlans = 0;
                if (plansSnapshot.exists()) {
                    const allPlans = plansSnapshot.val();
                    Object.values(allPlans).forEach(userPlans => {
                        activePlans += Object.values(userPlans).filter(p => p.claimsRemaining > 0).length;
                    });
                }
                document.getElementById('activePlans').textContent = activePlans;

                // Platform revenue (deposits - withdrawals)
                const revenue = totalDeposits - totalWithdrawals;
                document.getElementById('platformRevenue').textContent = revenue.toFixed(2);

                // Recent activities
                loadRecentActivities();
            } catch (error) {
                console.error('Error loading dashboard:', error);
            }
        }

        async function loadRecentActivities() {
            const tbody = document.getElementById('recentActivities');
            const activitiesRef = window.dbRef(window.database, 'activities');
            const snapshot = await window.dbGet(activitiesRef);

            if (!snapshot.exists()) {
                tbody.innerHTML = '<tr><td colspan="4" style="text-align: center;">No activities yet</td></tr>';
                return;
            }

            const allActivities = [];
            const activities = snapshot.val();
            
            Object.keys(activities).forEach(userId => {
                Object.values(activities[userId]).forEach(activity => {
                    allActivities.push({ ...activity, userId });
                });
            });

            allActivities.sort((a, b) => b.timestamp - a.timestamp);
            const recent = allActivities.slice(0, 10);

            tbody.innerHTML = recent.map(activity => `
                <tr>
                    <td>User ${activity.userId}</td>
                    <td>${activity.description}</td>
                    <td>$${activity.amount.toFixed(2)}</td>
                    <td>${new Date(activity.timestamp).toLocaleString()}</td>
                </tr>
            `).join('');
        }

        // Users
        let allUsers = [];
        async function loadUsers() {
            const usersRef = window.dbRef(window.database, 'users');
            const snapshot = await window.dbGet(usersRef);

            if (!snapshot.exists()) {
                document.getElementById('usersTable').innerHTML = '<tr><td colspan="8" style="text-align: center;">No users yet</td></tr>';
                return;
            }

            allUsers = Object.values(snapshot.val());
            displayUsers(allUsers);
        }

        function displayUsers(users) {
            const tbody = document.getElementById('usersTable');
            tbody.innerHTML = users.map(user => `
                <tr>
                    <td><img src="${user.photoUrl}" alt="${user.firstName}" class="user-avatar"></td>
                    <td>${user.firstName} ${user.lastName}</td>
                    <td>${user.id}</td>
                    <td>$${(user.balance || 0).toFixed(2)}</td>
                    <td>$${(user.totalDeposit || 0).toFixed(2)}</td>
                    <td>${user.referrals || 0}</td>
                    <td>${new Date(user.createdAt).toLocaleDateString()}</td>
                    <td>
                        <button class="btn btn-primary" onclick="editUser(${user.id})">Edit</button>
                    </td>
                </tr>
            `).join('');
        }

        function filterUsers() {
            const search = document.getElementById('userSearch').value.toLowerCase();
            const filtered = allUsers.filter(user => 
                user.firstName.toLowerCase().includes(search) ||
                user.lastName.toLowerCase().includes(search) ||
                user.id.toString().includes(search)
            );
            displayUsers(filtered);
        }

        function editUser(userId) {
            const user = allUsers.find(u => u.id === userId);
            if (!user) return;

            document.getElementById('editUserId').value = user.id;
            document.getElementById('editUserBalance').value = user.balance || 0;
            openModal('userModal');
        }

        async function updateUserBalance() {
            const userId = document.getElementById('editUserId').value;
            const newBalance = parseFloat(document.getElementById('editUserBalance').value);
            const action = document.getElementById('balanceAction').value;

            try {
                const userRef = window.dbRef(window.database, `users/${userId}`);
                const snapshot = await window.dbGet(userRef);
                const currentBalance = snapshot.val().balance || 0;

                let finalBalance = newBalance;
                if (action === 'add') {
                    finalBalance = currentBalance + newBalance;
                } else if (action === 'subtract') {
                    finalBalance = currentBalance - newBalance;
                }

                await window.dbUpdate(userRef, { balance: finalBalance });

                // Add activity
                const activityRef = window.dbPush(window.dbRef(window.database, `activities/${userId}`));
                await window.dbSet(activityRef, {
                    type: 'admin',
                    description: `Admin ${action} balance`,
                    amount: newBalance,
                    timestamp: Date.now()
                });

                // Send notification
                await sendTelegramNotification(
                    userId,
                    `💰 Balance Updated!\n\nYour balance has been updated by admin.\nNew Balance: $${finalBalance.toFixed(2)}`
                );

                showNotification('Balance updated successfully', 'success');
                closeModal('userModal');
                loadUsers();
                loadDashboard();
            } catch (error) {
                console.error('Error updating balance:', error);
                showNotification('Error updating balance', 'error');
            }
        }

        async function banUser() {
            const userId = document.getElementById('editUserId').value;
            if (!confirm('Are you sure you want to ban this user?')) return;

            try {
                const userRef = window.dbRef(window.database, `users/${userId}`);
                await window.dbUpdate(userRef, { banned: true, balance: 0 });

                await sendTelegramNotification(
                    userId,
                    `🚫 Account Banned\n\nYour account has been banned by admin. Contact support for more information.`
                );

                showNotification('User banned successfully', 'success');
                closeModal('userModal');
                loadUsers();
            } catch (error) {
                console.error('Error banning user:', error);
                showNotification('Error banning user', 'error');
            }
        }

        // Deposits
        async function loadDeposits() {
            const depositsRef = window.dbRef(window.database, 'deposits');
            const snapshot = await window.dbGet(depositsRef);

            if (!snapshot.exists()) {
                document.getElementById('depositsTable').innerHTML = '<tr><td colspan="8" style="text-align: center;">No deposits yet</td></tr>';
                return;
            }

            const deposits = snapshot.val();
            const depositsArray = Object.entries(deposits).map(([key, value]) => ({ key, ...value }));
            depositsArray.sort((a, b) => b.timestamp - a.timestamp);

            const tbody = document.getElementById('depositsTable');
            tbody.innerHTML = depositsArray.map(deposit => `
                <tr>
                    <td>${deposit.userName}</td>
                    <td>$${deposit.amount.toFixed(2)}</td>
                    <td style="max-width: 150px; overflow: hidden; text-overflow: ellipsis;">${deposit.txHash}</td>
                    <td style="max-width: 150px; overflow: hidden; text-overflow: ellipsis;">${deposit.address}</td>
                    <td>${deposit.memo}</td>
                    <td><span class="status-badge status-${deposit.status}">${deposit.status.toUpperCase()}</span></td>
                    <td>${new Date(deposit.timestamp).toLocaleString()}</td>
                    <td>
                        ${deposit.status === 'pending' ? `
                            <div class="action-buttons">
                                <button class="btn btn-success" onclick="approveDeposit('${deposit.key}', ${deposit.userId}, ${deposit.amount})">Approve</button>
                                <button class="btn btn-danger" onclick="rejectDeposit('${deposit.key}', ${deposit.userId})">Reject</button>
                            </div>
                        ` : '-'}
                    </td>
                </tr>
            `).join('');
        }

        async function approveDeposit(depositKey, userId, amount) {
            try {
                // Update deposit status
                const depositRef = window.dbRef(window.database, `deposits/${depositKey}`);
                await window.dbUpdate(depositRef, { status: 'approved' });

                // Update user balance
                const userRef = window.dbRef(window.database, `users/${userId}`);
                const userSnapshot = await window.dbGet(userRef);
                const userData = userSnapshot.val();
                
                await window.dbUpdate(userRef, {
                    balance: (userData.balance || 0) + amount,
                    totalDeposit: (userData.totalDeposit || 0) + amount,
                    hasDeposited: true
                });

                // Update history
                const historyRef = window.dbRef(window.database, `history/${userId}`);
                const historySnapshot = await window.dbGet(historyRef);
                if (historySnapshot.exists()) {
                    const history = historySnapshot.val();
                    Object.keys(history).forEach(async (key) => {
                        if (history[key].type === 'deposit' && history[key].amount === amount && history[key].status === 'pending') {
                            await window.dbUpdate(window.dbRef(window.database, `history/${userId}/${key}`), { status: 'approved' });
                        }
                    });
                }

                // Add activity
                const activityRef = window.dbPush(window.dbRef(window.database, `activities/${userId}`));
                await window.dbSet(activityRef, {
                    type: 'deposit',
                    description: 'Deposit approved',
                    amount: amount,
                    timestamp: Date.now()
                });

                // Handle referral bonus
                if (userData.referredBy) {
                    const referrerRef = window.dbRef(window.database, `users/${userData.referredBy}`);
                    const referrerSnapshot = await window.dbGet(referrerRef);
                    if (referrerSnapshot.exists()) {
                        const referrer = referrerSnapshot.val();
                        const commission = amount * 0.2; // 20% commission
                        
                        await window.dbUpdate(referrerRef, {
                            balance: (referrer.balance || 0) + commission,
                            referralEarnings: (referrer.referralEarnings || 0) + commission
                        });

                        await sendTelegramNotification(
                            userData.referredBy,
                            `💰 Referral Commission!\n\nYou earned $${commission.toFixed(2)} from your referral's deposit!\nNew Balance: $${((referrer.balance || 0) + commission).toFixed(2)}`
                        );
                    }
                }

                // Send notification
                await sendTelegramNotification(
                    userId,
                    `✅ Deposit Approved!\n\nAmount: $${amount.toFixed(2)}\nDate: ${new Date().toLocaleString()}\n\nYour balance has been updated.`
                );

                showNotification('Deposit approved successfully', 'success');
                loadDeposits();
                loadDashboard();
            } catch (error) {
                console.error('Error approving deposit:', error);
                showNotification('Error approving deposit', 'error');
            }
        }

        async function rejectDeposit(depositKey, userId) {
            try {
                // Update deposit status
                const depositRef = window.dbRef(window.database, `deposits/${depositKey}`);
                await window.dbUpdate(depositRef, { status: 'rejected' });

                // Update history
                const historyRef = window.dbRef(window.database, `history/${userId}`);
                const historySnapshot = await window.dbGet(historyRef);
                if (historySnapshot.exists()) {
                    const history = historySnapshot.val();
                    Object.keys(history).forEach(async (key) => {
                        if (history[key].type === 'deposit' && history[key].status === 'pending') {
                            await window.dbUpdate(window.dbRef(window.database, `history/${userId}/${key}`), { status: 'rejected' });
                        }
                    });
                }

                // Send notification
                await sendTelegramNotification(
                    userId,
                    `❌ Deposit Rejected\n\nYour deposit has been rejected. Please contact support for more information.`
                );

                showNotification('Deposit rejected', 'success');
                loadDeposits();
                loadDashboard();
            } catch (error) {
                console.error('Error rejecting deposit:', error);
                showNotification('Error rejecting deposit', 'error');
            }
        }

        // Withdrawals
        async function loadWithdrawals() {
            const withdrawalsRef = window.dbRef(window.database, 'withdrawals');
            const snapshot = await window.dbGet(withdrawalsRef);

            if (!snapshot.exists()) {
                document.getElementById('withdrawalsTable').innerHTML = '<tr><td colspan="7" style="text-align: center;">No withdrawals yet</td></tr>';
                return;
            }

            const withdrawals = snapshot.val();
            const withdrawalsArray = Object.entries(withdrawals).map(([key, value]) => ({ key, ...value }));
            withdrawalsArray.sort((a, b) => b.timestamp - a.timestamp);

            const tbody = document.getElementById('withdrawalsTable');
            tbody.innerHTML = withdrawalsArray.map(withdrawal => `
                <tr>
                    <td>${withdrawal.userName}</td>
                    <td>$${withdrawal.amount.toFixed(2)}</td>
                    <td style="max-width: 150px; overflow: hidden; text-overflow: ellipsis;">${withdrawal.address}</td>
                    <td>${withdrawal.memo || '-'}</td>
                    <td><span class="status-badge status-${withdrawal.status}">${withdrawal.status.toUpperCase()}</span></td>
                    <td>${new Date(withdrawal.timestamp).toLocaleString()}</td>
                    <td>
                        ${withdrawal.status === 'pending' ? `
                            <div class="action-buttons">
                                <button class="btn btn-success" onclick="approveWithdrawal('${withdrawal.key}', ${withdrawal.userId}, ${withdrawal.amount})">Approve</button>
                                <button class="btn btn-danger" onclick="rejectWithdrawal('${withdrawal.key}', ${withdrawal.userId}, ${withdrawal.amount})">Reject</button>
                            </div>
                        ` : '-'}
                    </td>
                </tr>
            `).join('');
        }

        async function approveWithdrawal(withdrawalKey, userId, amount) {
            try {
                // Update withdrawal status
                const withdrawalRef = window.dbRef(window.database, `withdrawals/${withdrawalKey}`);
                await window.dbUpdate(withdrawalRef, { status: 'approved' });

                // Update user total withdraw
                const userRef = window.dbRef(window.database, `users/${userId}`);
                const userSnapshot = await window.dbGet(userRef);
                const userData = userSnapshot.val();
                
                await window.dbUpdate(userRef, {
                    totalWithdraw: (userData.totalWithdraw || 0) + amount
                });

                // Update history
                const historyRef = window.dbRef(window.database, `history/${userId}`);
                const historySnapshot = await window.dbGet(historyRef);
                if (historySnapshot.exists()) {
                    const history = historySnapshot.val();
                    Object.keys(history).forEach(async (key) => {
                        if (history[key].type === 'withdraw' && history[key].amount === amount && history[key].status === 'pending') {
                            await window.dbUpdate(window.dbRef(window.database, `history/${userId}/${key}`), { status: 'approved' });
                        }
                    });
                }

                // Send notification
                await sendTelegramNotification(
                    userId,
                    `✅ Withdrawal Approved!\n\nAmount: $${amount.toFixed(2)}\nDate: ${new Date().toLocaleString()}\n\nYour withdrawal has been processed.`
                );

                showNotification('Withdrawal approved successfully', 'success');
                loadWithdrawals();
                loadDashboard();
            } catch (error) {
                console.error('Error approving withdrawal:', error);
                showNotification('Error approving withdrawal', 'error');
            }
        }

        async function rejectWithdrawal(withdrawalKey, userId, amount) {
            try {
                // Update withdrawal status
                const withdrawalRef = window.dbRef(window.database, `withdrawals/${withdrawalKey}`);
                await window.dbUpdate(withdrawalRef, { status: 'rejected' });

                // Refund balance
                const userRef = window.dbRef(window.database, `users/${userId}`);
                const userSnapshot = await window.dbGet(userRef);
                const userData = userSnapshot.val();
                
                await window.dbUpdate(userRef, {
                    balance: (userData.balance || 0) + amount
                });

                // Update history
                const historyRef = window.dbRef(window.database, `history/${userId}`);
                const historySnapshot = await window.dbGet(historyRef);
                if (historySnapshot.exists()) {
                    const history = historySnapshot.val();
                    Object.keys(history).forEach(async (key) => {
                        if (history[key].type === 'withdraw' && history[key].amount === amount && history[key].status === 'pending') {
                            await window.dbUpdate(window.dbRef(window.database, `history/${userId}/${key}`), { status: 'rejected' });
                        }
                    });
                }

                // Send notification
                await sendTelegramNotification(
                    userId,
                    `❌ Withdrawal Rejected\n\nAmount: $${amount.toFixed(2)}\n\nYour withdrawal has been rejected and the amount has been refunded to your balance.`
                );

                showNotification('Withdrawal rejected and refunded', 'success');
                loadWithdrawals();
                loadDashboard();
            } catch (error) {
                console.error('Error rejecting withdrawal:', error);
                showNotification('Error rejecting withdrawal', 'error');
            }
        }

        // User Plans
        async function loadUserPlans() {
            const plansRef = window.dbRef(window.database, 'userPlans');
            const snapshot = await window.dbGet(plansRef);

            if (!snapshot.exists()) {
                document.getElementById('userPlansTable').innerHTML = '<tr><td colspan="7" style="text-align: center;">No active plans yet</td></tr>';
                return;
            }

            const allPlans = [];
            const plans = snapshot.val();
            
            Object.keys(plans).forEach(userId => {
                Object.values(plans[userId]).forEach(plan => {
                    allPlans.push({ ...plan, userId });
                });
            });

            allPlans.sort((a, b) => b.purchasedAt - a.purchasedAt);

            const tbody = document.getElementById('userPlansTable');
            tbody.innerHTML = allPlans.map(plan => `
                <tr>
                    <td>User ${plan.userId}</td>
                    <td>${plan.pair}</td>
                    <td>$${plan.price.toFixed(2)}</td>
                    <td>$${plan.dailyEarning.toFixed(2)}</td>
                    <td>${plan.claimsRemaining}</td>
                    <td>$${(plan.totalEarned || 0).toFixed(2)}</td>
                    <td>${new Date(plan.purchasedAt).toLocaleDateString()}</td>
                </tr>
            `).join('');
        }

        // Tasks
        async function loadTasks() {
            const tasksRef = window.dbRef(window.database, 'tasks');
            const snapshot = await window.dbGet(tasksRef);

            if (!snapshot.exists()) {
                document.getElementById('tasksTable').innerHTML = '<tr><td colspan="5" style="text-align: center;">No tasks yet</td></tr>';
                return;
            }

            const tasks = snapshot.val();
            const tbody = document.getElementById('tasksTable');
            tbody.innerHTML = Object.entries(tasks).map(([key, task]) => `
                <tr>
                    <td><img src="${task.logo}" alt="Logo" style="width: 40px; height: 40px; border-radius: 8px;"></td>
                    <td>${task.heading}</td>
                    <td style="max-width: 200px; overflow: hidden; text-overflow: ellipsis;">${task.description}</td>
                    <td>$${task.reward.toFixed(2)}</td>
                    <td>
                        <button class="btn btn-danger" onclick="deleteTask('${key}')">Delete</button>
                    </td>
                </tr>
            `).join('');
        }

        async function addTask() {
            const logo = document.getElementById('taskLogo').value.trim();
            const heading = document.getElementById('taskHeading').value.trim();
            const description = document.getElementById('taskDescription').value.trim();
            const link = document.getElementById('taskLink').value.trim();
            const reward = parseFloat(document.getElementById('taskReward').value);

            if (!logo || !heading || !description || !link || !reward) {
                showNotification('Please fill all fields', 'error');
                return;
            }

            try {
                const taskRef = window.dbPush(window.dbRef(window.database, 'tasks'));
                await window.dbSet(taskRef, {
                    logo,
                    heading,
                    description,
                    link,
                    reward,
                    createdAt: Date.now()
                });

                showNotification('Task added successfully', 'success');
                document.getElementById('taskLogo').value = '';
                document.getElementById('taskHeading').value = '';
                document.getElementById('taskDescription').value = '';
                document.getElementById('taskLink').value = '';
                document.getElementById('taskReward').value = '';
                loadTasks();
            } catch (error) {
                console.error('Error adding task:', error);
                showNotification('Error adding task', 'error');
            }
        }

        async function deleteTask(taskKey) {
            if (!confirm('Are you sure you want to delete this task?')) return;

            try {
                const taskRef = window.dbRef(window.database, `tasks/${taskKey}`);
                await window.dbRemove(taskRef);
                showNotification('Task deleted successfully', 'success');
                loadTasks();
            } catch (error) {
                console.error('Error deleting task:', error);
                showNotification('Error deleting task', 'error');
            }
        }

        // Redeem Codes
        async function loadRedeemCodes() {
            const codesRef = window.dbRef(window.database, 'redeemCodes');
            const snapshot = await window.dbGet(codesRef);

            if (!snapshot.exists()) {
                document.getElementById('redeemCodesTable').innerHTML = '<tr><td colspan="6" style="text-align: center;">No redeem codes yet</td></tr>';
                return;
            }

            const codes = snapshot.val();
            const tbody = document.getElementById('redeemCodesTable');
            tbody.innerHTML = Object.entries(codes).map(([code, data]) => `
                <tr>
                    <td style="font-weight: bold; color: var(--success-color);">${code}</td>
                    <td>$${data.minAmount.toFixed(2)} - $${data.maxAmount.toFixed(2)}</td>
                    <td>${data.maxUses === 0 ? 'Unlimited' : data.maxUses}</td>
                    <td><span class="status-badge ${data.used ? 'status-rejected' : 'status-approved'}">${data.used ? 'USED' : 'ACTIVE'}</span></td>
                    <td>${new Date(data.createdAt).toLocaleDateString()}</td>
                    <td>
                        <button class="btn btn-danger" onclick="deleteRedeemCode('${code}')">Delete</button>
                    </td>
                </tr>
            `).join('');
        }

        async function generateRedeemCode() {
            const minAmount = parseFloat(document.getElementById('redeemMin').value);
            const maxAmount = parseFloat(document.getElementById('redeemMax').value);
            const maxUses = parseInt(document.getElementById('redeemUses').value);

            if (minAmount >= maxAmount) {
                showNotification('Maximum amount must be greater than minimum', 'error');
                return;
            }

            try {
                // Generate random 8-digit code
                const code = Math.random().toString(36).substring(2, 10).toUpperCase();
                const amount = Math.random() * (maxAmount - minAmount) + minAmount;

                const codeRef = window.dbRef(window.database, `redeemCodes/${code}`);
                await window.dbSet(codeRef, {
                    code,
                    amount: parseFloat(amount.toFixed(2)),
                    minAmount,
                    maxAmount,
                    maxUses,
                    used: false,
                    usedBy: [],
                    createdAt: Date.now()
                });

                document.getElementById('generatedCode').innerHTML = `
                    <div class="code-display">${code}</div>
                    <p style="text-align: center; color: var(--text-secondary);">
                        Value: $${amount.toFixed(2)}
                    </p>
                `;

                showNotification('Redeem code generated successfully', 'success');
                loadRedeemCodes();
            } catch (error) {
                console.error('Error generating code:', error);
                showNotification('Error generating code', 'error');
            }
        }

        async function deleteRedeemCode(code) {
            if (!confirm('Are you sure you want to delete this code?')) return;

            try {
                const codeRef = window.dbRef(window.database, `redeemCodes/${code}`);
                await window.dbRemove(codeRef);
                showNotification('Code deleted successfully', 'success');
                loadRedeemCodes();
            } catch (error) {
                console.error('Error deleting code:', error);
                showNotification('Error deleting code', 'error');
            }
        }

        // Branding
        async function saveBranding() {
            const platformName = document.getElementById('platformName').value;
            const welcomeMessage = document.getElementById('welcomeMessage').value;
            const supportLink = document.getElementById('supportLink').value;
            const minDeposit = parseFloat(document.getElementById('minDeposit').value);
            const minWithdraw = parseFloat(document.getElementById('minWithdraw').value);

            try {
                const settingsRef = window.dbRef(window.database, 'settings');
                await window.dbSet(settingsRef, {
                    platformName,
                    welcomeMessage,
                    supportLink,
                    minDeposit,
                    minWithdraw,
                    updatedAt: Date.now()
                });

                showNotification('Settings saved successfully', 'success');
            } catch (error) {
                console.error('Error saving settings:', error);
                showNotification('Error saving settings', 'error');
            }
        }

        // Utility Functions
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(sectionId).classList.add('active');

            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.closest('.menu-item').classList.add('active');
        }

        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        async function sendTelegramNotification(userId, message) {
            try {
                await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        chat_id: userId,
                        text: message,
                        parse_mode: 'HTML'
                    })
                });
            } catch (error) {
                console.error('Error sending Telegram notification:', error);
            }
        }
    </script>
</body>
</html>
